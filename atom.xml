<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zhuqiaolun - 个人博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.zhuqiaolun.com/"/>
  <updated>2022-02-14T10:11:05.540Z</updated>
  <id>https://www.zhuqiaolun.com/</id>
  
  <author>
    <name>十二</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Yaml的配置文件读取</title>
    <link href="https://www.zhuqiaolun.com/2022/02/1644832599629/1644832599629/"/>
    <id>https://www.zhuqiaolun.com/2022/02/1644832599629/1644832599629/</id>
    <published>2022-02-14T09:56:39.000Z</published>
    <updated>2022-02-14T10:11:05.540Z</updated>
    
    <content type="html"><![CDATA[<h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.yaml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>snakeyaml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>在项目resources下存在文件：config.yaml<br>内容如下：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YAML"><figure class="iseeu highlight /yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code:</span> <span class="number">000</span></span><br><span class="line"><span class="attr">message:</span> <span class="string">"成功"</span></span><br><span class="line"><span class="attr">stringList:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">"hello"</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">"world"</span></span><br></pre></td></tr></tbody></table></figure></div><p>只要定义同等名称及类型即可赋值获取</p><h3 id="类YamlUtils"><a href="#类YamlUtils" class="headerlink" title="类YamlUtils"></a>类YamlUtils</h3><p>采用 @Data 注解 省略set/get 方法</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import org.yaml.snakeyaml.Yaml;</span><br><span class="line"></span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * author ：demon</span><br><span class="line"> * date ：2021 2021/8/15 14:51</span><br><span class="line"> * desc ：读取yaml文件，并获取值</span><br><span class="line"> */</span><br><span class="line">@Data</span><br><span class="line">public class YamlUtils {</span><br><span class="line"></span><br><span class="line">    private static YamlUtils yamlUtils;</span><br><span class="line"></span><br><span class="line">    public static YamlUtils getInstance() {</span><br><span class="line">        if (yamlUtils == null) {</span><br><span class="line">            yamlUtils = new YamlUtils();</span><br><span class="line">        }</span><br><span class="line">        return yamlUtils;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    static {</span><br><span class="line">        try {</span><br><span class="line">            Yaml yaml = new Yaml();</span><br><span class="line">            InputStream inputStream = YamlUtils.class.getResourceAsStream("/config.yaml");</span><br><span class="line">            // 可以将值转换为Map，通过map我们取值就可以了.</span><br><span class="line">            Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> ymlMap = yaml.load(inputStream);</span><br><span class="line">            // 动态赋值</span><br><span class="line">            yamlUtils = YamlUtils.class.newInstance();</span><br><span class="line">            for (Field field : yamlUtils.getClass().getDeclaredFields()) {</span><br><span class="line">                if (ymlMap.containsKey(field.getName())) {</span><br><span class="line">                    boolean flag = field.isAccessible();</span><br><span class="line">                    field.setAccessible(true);</span><br><span class="line">                    Object object = ymlMap.get(field.getName());</span><br><span class="line">                    if (object != null &amp;&amp; field.getType().isAssignableFrom(object.getClass())) {</span><br><span class="line">                        field.set(yamlUtils, object);</span><br><span class="line">                    }</span><br><span class="line">                    field.setAccessible(flag);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private Integer code;</span><br><span class="line">    private String message;</span><br><span class="line">    private List<span class="tag">&lt;<span class="name">String</span>&gt;</span> stringList;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void Test1(){</span><br><span class="line">  System.out.println(YamlUtils.getInstance().getCode());</span><br><span class="line">  System.out.println(YamlUtils.getInstance().getMessage());</span><br><span class="line">  System.out.println(YamlUtils.getInstance().getStringList());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Yaml的配置文件读取
    
    </summary>
    
    
      <category term="J-Tools" scheme="https://www.zhuqiaolun.com/categories/J-Tools/"/>
    
    
      <category term="Yaml" scheme="https://www.zhuqiaolun.com/tags/Yaml/"/>
    
  </entry>
  
  <entry>
    <title>Maven多模块指定模块工程打包</title>
    <link href="https://www.zhuqiaolun.com/2022/02/1644831407066/1644831407066/"/>
    <id>https://www.zhuqiaolun.com/2022/02/1644831407066/1644831407066/</id>
    <published>2022-02-14T09:36:47.000Z</published>
    <updated>2022-02-14T09:53:24.539Z</updated>
    
    <content type="html"><![CDATA[<h3 id="打包说明"><a href="#打包说明" class="headerlink" title="打包说明"></a>打包说明</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Maven多模块工程打包指定模块工程执行如下命令：</span><br><span class="line">mvn clean package -pl  指定模块工程名 -am</span><br><span class="line"></span><br><span class="line">参数说明：</span><br><span class="line">-am --also-make 同时构建所列模块的依赖模块；</span><br><span class="line">-amd -also-make-dependents 同时构建依赖于所列模块的模块；</span><br><span class="line">-pl --projects <span class="tag">&lt;<span class="name">arg</span>&gt;</span> 构建制定的模块，模块间用逗号分隔；</span><br><span class="line">-rf -resume-from <span class="tag">&lt;<span class="name">arg</span>&gt;</span> 从指定的模块恢复反应堆。</span><br></pre></td></tr></tbody></table></figure></div><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Parent</span><br><span class="line">  - common          公共模块</span><br><span class="line">  - deploy          部署模块</span><br><span class="line">    - service1      部署服务1 -&gt; 引入 服务1</span><br><span class="line">    - service2      部署服务2 -&gt; 引入 服务2</span><br><span class="line">    - service3      部署服务3 -&gt; 引入 服务3</span><br><span class="line">  - forward         第三方模块 -&gt; 引入 公共模块</span><br><span class="line">  - framework       Spring模块 -&gt; 引入 公共模块</span><br><span class="line">  - service         服务模块</span><br><span class="line">    - service1      服务1 -&gt; 引入 Spring模块</span><br><span class="line">    - service2      服务2 -&gt; 引入 Spring模块</span><br><span class="line">    - service3      服务3 -&gt; 引入 Spring模块</span><br></pre></td></tr></tbody></table></figure></div><h3 id="打包命令"><a href="#打包命令" class="headerlink" title="打包命令"></a>打包命令</h3><p>在根目录Parent下进行打包</p><blockquote><p>打包部署service1模块 :<br>  mvn clean package -pl deploy/service1 -am</p></blockquote><blockquote><p>打包部署service2模块 :<br>  mvn clean package -pl deploy/service2 -am</p></blockquote><blockquote><p>打包部署service3模块 :<br>  mvn clean package -pl deploy/service3 -am</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Maven多模块工程打包
    
    </summary>
    
    
      <category term="Maven" scheme="https://www.zhuqiaolun.com/categories/Maven/"/>
    
    
      <category term="pom" scheme="https://www.zhuqiaolun.com/tags/pom/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot日志之logback</title>
    <link href="https://www.zhuqiaolun.com/2022/02/1644829623396/1644829623396/"/>
    <id>https://www.zhuqiaolun.com/2022/02/1644829623396/1644829623396/</id>
    <published>2022-02-14T09:07:03.000Z</published>
    <updated>2022-02-14T09:35:44.040Z</updated>
    
    <content type="html"><![CDATA[<h3 id="自定义日志根路径："><a href="#自定义日志根路径：" class="headerlink" title="自定义日志根路径："></a>自定义日志根路径：</h3><p>一般在jar中使用</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">define</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span> <span class="attr">class</span>=<span class="string">"com.xxx.framework.config.LogHomeConfig"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.dirPath"</span> <span class="attr">value</span>=<span class="string">"${LOG_HOME}"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><p><a href="#LogHomeConfig">LogHomeConfig</a></p><h3 id="日志路径在Tomcat下："><a href="#日志路径在Tomcat下：" class="headerlink" title="日志路径在Tomcat下："></a>日志路径在Tomcat下：</h3><p>一般在war中使用</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.dirPath"</span> <span class="attr">value</span>=<span class="string">"${catalina.base}/logs"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><p>引入文件 logback-spring.xml<br>内容如下：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志级别以及优先级排序: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">status              log4j2自身日志输出等级</span></span><br><span class="line"><span class="comment">monitorInterval     自动检测间隔 30s</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">scan</span>=<span class="string">"true"</span> <span class="attr">scanPeriod</span>=<span class="string">"30 seconds"</span> <span class="attr">debug</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 日志格式和颜色渲染 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 彩色日志依赖的渲染类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">"clr"</span> <span class="attr">converterClass</span>=<span class="string">"org.springframework.boot.logging.logback.ColorConverter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">"wex"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">converterClass</span>=<span class="string">"org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">"wEx"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">converterClass</span>=<span class="string">"org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 设置上下文名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span> <span class="attr">value</span>=<span class="string">"project-name"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- 定义日志根目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.dirPath"</span> <span class="attr">value</span>=<span class="string">"${catalina.base}/logs"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 定义日志目录参数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.contextName"</span> <span class="attr">value</span>=<span class="string">"project-name/logs"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.lever"</span> <span class="attr">value</span>=<span class="string">"DEBUG"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.pattern"</span> <span class="attr">value</span>=<span class="string">"%d{yyyy-MM-dd HH:mm:ss.SSS,CTT}[%p][%t] %c[%L] %m %n"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.MaxFileSize"</span> <span class="attr">value</span>=<span class="string">"1MB"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logback.maxHistory"</span> <span class="attr">value</span>=<span class="string">"7"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 日志格式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"CONSOLE_LOG_PATTERN"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">"${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS,CTT}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--子节点一: 输出到控制台 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"CONSOLE_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.ThresholdFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>${CONSOLE_LOG_PATTERN}<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 输出到文件 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 按照每天生成日志文件 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- TRACE --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"TRACE_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>${logback.dirPath}/${logback.contextName}/trace.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件输出的文件名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>${logback.dirPath}/${logback.contextName}/%d{yyyy-MM-dd}/trace.logs-%i.log</span><br><span class="line">            <span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件最大的大小--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>${logback.MaxFileSize}<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>${logback.maxHistory}<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>${logback.pattern}<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>TRACE<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- DEBUG --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"DEBUG_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>${logback.dirPath}/${logback.contextName}/debug.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>${logback.dirPath}/${logback.contextName}/%d{yyyy-MM-dd}/debug.logs-%i.log</span><br><span class="line">            <span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>${logback.MaxFileSize}<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>${logback.maxHistory}<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>${logback.pattern}<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>DEBUG<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- INFO --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"INFO_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>${logback.dirPath}/${logback.contextName}/info.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>${logback.dirPath}/${logback.contextName}/%d{yyyy-MM-dd}/info.logs-%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>${logback.MaxFileSize}<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>${logback.maxHistory}<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>${logback.pattern}<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- WARN --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"WARN_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>${logback.dirPath}/${logback.contextName}/warn.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>${logback.dirPath}/${logback.contextName}/%d{yyyy-MM-dd}/warn.logs-%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>${logback.MaxFileSize}<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>${logback.maxHistory}<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>${logback.pattern}<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>WARN<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ERROR --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"ERROR_APPENDER"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>${logback.dirPath}/${logback.contextName}/error.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>${logback.dirPath}/${logback.contextName}/%d{yyyy-MM-dd}/error.logs-%i.log</span><br><span class="line">            <span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>${logback.MaxFileSize}<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>${logback.maxHistory}<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>${logback.pattern}<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.LevelFilter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--第三方日志配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.apache.axis"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.apache.http"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.baomidou.mybatisplus.core.MybatisConfiguration"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.zaxxer.hikari"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.springframework"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.springframework.web.servlet.DispatcherServlet"</span> <span class="attr">level</span>=<span class="string">"${logback.lever}"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 日志输出级别 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"${logback.lever}"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"CONSOLE_APPENDER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"TRACE_APPENDER"</span>  /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"DEBUG_APPENDER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"INFO_APPENDER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"WARN_APPENDER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"ERROR_APPENDER"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="LogHomeConfig"><a href="#LogHomeConfig" class="headerlink" title="LogHomeConfig"></a>LogHomeConfig</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import ch.qos.logback.core.PropertyDefinerBase;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * className    LogHomeConfig</span><br><span class="line"> * author       demon</span><br><span class="line"> * createTime   2021/4/15 13:51</span><br><span class="line"> * description  logback日志路径配置</span><br><span class="line"> * 由logback-spring.xml使用：例如：</span><br><span class="line"> * <span class="tag">&lt;<span class="name">define</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span> <span class="attr">class</span>=<span class="string">"com.xxx.framework.config.LogHomeConfig"</span> /&gt;</span></span><br><span class="line"> */</span><br><span class="line">public class LogHomeConfig extends PropertyDefinerBase {</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getPropertyValue() {</span><br><span class="line">        String logHome = System.getProperty("user.home") + File.separator + "project-name";</span><br><span class="line">        System.out.println("自定义日志路径:" + logHome);</span><br><span class="line">        return logHome;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      SpringBoot日志之logback
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://www.zhuqiaolun.com/categories/SpringBoot/"/>
    
    
      <category term="logback" scheme="https://www.zhuqiaolun.com/tags/logback/"/>
    
  </entry>
  
  <entry>
    <title>分布式自增ID算法---雪花算法</title>
    <link href="https://www.zhuqiaolun.com/2022/02/1644472320483/1644472320483/"/>
    <id>https://www.zhuqiaolun.com/2022/02/1644472320483/1644472320483/</id>
    <published>2022-02-10T05:52:00.000Z</published>
    <updated>2022-02-14T09:01:27.810Z</updated>
    
    <content type="html"><![CDATA[<h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><p>SnowFlake的结构如下(每部分用-分开):<br>0 - 0000000000 0000000000 0000000000 0000000000 0 - 00000 - 00000 - 000000000000<br>1位标识，由于long基本类型在Java中是带符号的，最高位是符号位，正数是0，负数是1，所以id一般是正数，最高位是0<br>41位时间截(毫秒级)，注意，41位时间截不是存储当前时间的时间截，而是存储时间截的差值（当前时间截 - 开始时间截)得到的值），<br>这里的的开始时间截，一般是我们的id生成器开始使用的时间，由我们程序来指定的（如下下面程序IdWorker类的startTime属性）。<br>41位的时间截，可以使用69年，年T = (1L &lt;&lt; 41) / (1000L * 60 * 60 * 24 * 365) = 69<br>10位的数据机器位，可以部署在1024个节点，包括5位datacenterId和5位workerId<br>12位序列，毫秒内的计数，12位的计数顺序号支持每个节点每毫秒(同一机器，同一时间截)产生4096个ID序号加起来刚好64位，为一个Long型。</p><p>SnowFlake的优点是，整体上按照时间自增排序，并且整个分布式系统内不会产生ID碰撞(由数据中心ID和机器ID作区分)，并且效率较高，经测试，SnowFlake每秒能够产生26万ID左右。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">public class SnowflakeIdWorker {</span><br><span class="line"></span><br><span class="line">    /** 开始时间截 (2015-01-01) */</span><br><span class="line">    private final long twepoch = 1489111610226L;</span><br><span class="line"></span><br><span class="line">    /** 机器id所占的位数 */</span><br><span class="line">    private final long workerIdBits = 5L;</span><br><span class="line"></span><br><span class="line">    /** 数据标识id所占的位数 */</span><br><span class="line">    private final long dataCenterIdBits = 5L;</span><br><span class="line"></span><br><span class="line">    /** 支持的最大机器id，结果是31 (这个移位算法可以很快的计算出几位二进制数所能表示的最大十进制数) */</span><br><span class="line">    private final long maxWorkerId = -1L ^ (-1L &lt;&lt; workerIdBits);</span><br><span class="line"></span><br><span class="line">    /** 支持的最大数据标识id，结果是31 */</span><br><span class="line">    private final long maxDataCenterId = -1L ^ (-1L &lt;&lt; dataCenterIdBits);</span><br><span class="line"></span><br><span class="line">    /** 序列在id中占的位数 */</span><br><span class="line">    private final long sequenceBits = 12L;</span><br><span class="line"></span><br><span class="line">    /** 机器ID向左移12位 */</span><br><span class="line">    private final long workerIdShift = sequenceBits;</span><br><span class="line"></span><br><span class="line">    /** 数据标识id向左移17位(12+5) */</span><br><span class="line">    private final long dataCenterIdShift = sequenceBits + workerIdBits;</span><br><span class="line"></span><br><span class="line">    /** 时间截向左移22位(5+5+12) */</span><br><span class="line">    private final long timestampLeftShift = sequenceBits + workerIdBits + dataCenterIdBits;</span><br><span class="line"></span><br><span class="line">    /** 生成序列的掩码，这里为4095 (0b111111111111=0xfff=4095) */</span><br><span class="line">    private final long sequenceMask = -1L ^ (-1L &lt;&lt; sequenceBits);</span><br><span class="line"></span><br><span class="line">    /** 工作机器ID(0~31) */</span><br><span class="line">    private long workerId;</span><br><span class="line"></span><br><span class="line">    /** 数据中心ID(0~31) */</span><br><span class="line">    private long dataCenterId;</span><br><span class="line"></span><br><span class="line">    /** 毫秒内序列(0~4095) */</span><br><span class="line">    private long sequence = 0L;</span><br><span class="line"></span><br><span class="line">    /** 上次生成ID的时间截 */</span><br><span class="line">    private long lastTimestamp = -1L;</span><br><span class="line"></span><br><span class="line">    //==============================Constructors=====================================</span><br><span class="line">    /**</span><br><span class="line">     * 构造函数</span><br><span class="line">     * @param workerId 工作ID (0~31)</span><br><span class="line">     * @param dataCenterId 数据中心ID (0~31)</span><br><span class="line">     */</span><br><span class="line">    public SnowflakeIdWorker(long workerId, long dataCenterId) {</span><br><span class="line">        if (workerId &gt; maxWorkerId || workerId <span class="tag">&lt; <span class="attr">0</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">throw</span> <span class="attr">new</span> <span class="attr">IllegalArgumentException</span>(<span class="attr">String.format</span>("<span class="attr">workerId</span> <span class="attr">can</span>'<span class="attr">t</span> <span class="attr">be</span> <span class="attr">greater</span> <span class="attr">than</span> %<span class="attr">d</span> <span class="attr">or</span> <span class="attr">less</span> <span class="attr">than</span> <span class="attr">0</span>", <span class="attr">maxWorkerId</span>));</span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">        <span class="attr">if</span> (<span class="attr">dataCenterId</span> &gt;</span> maxDataCenterId || dataCenterId <span class="tag">&lt; <span class="attr">0</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">throw</span> <span class="attr">new</span> <span class="attr">IllegalArgumentException</span>(<span class="attr">String.format</span>("<span class="attr">dataCenterId</span> <span class="attr">can</span>'<span class="attr">t</span> <span class="attr">be</span> <span class="attr">greater</span> <span class="attr">than</span> %<span class="attr">d</span> <span class="attr">or</span> <span class="attr">less</span> <span class="attr">than</span> <span class="attr">0</span>", <span class="attr">maxDataCenterId</span>));</span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">        <span class="attr">this.workerId</span> = <span class="string">workerId;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">this.dataCenterId</span> = <span class="string">dataCenterId;</span></span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    // ==============================<span class="string">Methods</span>==========================================</span></span><br><span class="line"><span class="tag">    /**</span></span><br><span class="line"><span class="tag">     * 获得下一个<span class="attr">ID</span> (该方法是线程安全的)</span></span><br><span class="line"><span class="tag">     * @<span class="attr">return</span> <span class="attr">SnowflakeId</span></span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">public</span> <span class="attr">synchronized</span> <span class="attr">long</span> <span class="attr">nextId</span>() {</span></span><br><span class="line"><span class="tag">        <span class="attr">long</span> <span class="attr">timestamp</span> = <span class="string">timeGen();</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        //如果当前时间小于上一次<span class="attr">ID</span>生成的时间戳，说明系统时钟回退过这个时候应当抛出异常</span></span><br><span class="line">        if (timestamp &lt; lastTimestamp) {</span><br><span class="line">            throw new RuntimeException(</span><br><span class="line">                    String.format("Clock moved backwards.  Refusing to generate id for %d milliseconds", lastTimestamp - timestamp));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        //如果是同一时间生成的，则进行毫秒内序列</span><br><span class="line">        if (lastTimestamp == timestamp) {</span><br><span class="line">            sequence = (sequence + 1) &amp; sequenceMask;</span><br><span class="line">            //毫秒内序列溢出</span><br><span class="line">            if (sequence == 0) {</span><br><span class="line">                //阻塞到下一个毫秒,获得新的时间戳</span><br><span class="line">                timestamp = tilNextMillis(lastTimestamp);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        //时间戳改变，毫秒内序列重置</span><br><span class="line">        else {</span><br><span class="line">            sequence = 0L;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        //上次生成ID的时间截</span><br><span class="line">        lastTimestamp = timestamp;</span><br><span class="line"></span><br><span class="line">        //移位并通过或运算拼到一起组成64位的ID</span><br><span class="line">        return ((timestamp - twepoch) &lt;&lt; timestampLeftShift) //</span><br><span class="line">                | (dataCenterId &lt;&lt; dataCenterIdShift) //</span><br><span class="line">                | (workerId &lt;&lt; workerIdShift) //</span><br><span class="line">                | sequence;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 阻塞到下一个毫秒，直到获得新的时间戳</span><br><span class="line">     * @param lastTimestamp 上次生成ID的时间截</span><br><span class="line">     * @return 当前时间戳</span><br><span class="line">     */</span><br><span class="line">    protected long tilNextMillis(long lastTimestamp) {</span><br><span class="line">        long timestamp = timeGen();</span><br><span class="line">        while (timestamp <span class="tag">&lt;<span class="name">=</span> <span class="attr">lastTimestamp</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">timestamp</span> = <span class="string">timeGen();</span></span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">        <span class="attr">return</span> <span class="attr">timestamp</span>;</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    /**</span></span><br><span class="line"><span class="tag">     * 返回以毫秒为单位的当前时间</span></span><br><span class="line"><span class="tag">     * @<span class="attr">return</span> 当前时间(毫秒)</span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">protected</span> <span class="attr">long</span> <span class="attr">timeGen</span>() {</span></span><br><span class="line"><span class="tag">        <span class="attr">return</span> <span class="attr">System.currentTimeMillis</span>();</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">}</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) {</span><br><span class="line">    System.out.println(System.currentTimeMillis());</span><br><span class="line">    SnowflakeIdWorker idWorker = new SnowflakeIdWorker(1, 1);</span><br><span class="line">    long startTime = System.nanoTime();</span><br><span class="line">    for (int i = 0; i <span class="tag">&lt; <span class="attr">50000</span>; <span class="attr">i</span>++) {</span></span><br><span class="line"><span class="tag">        <span class="attr">long</span> <span class="attr">id</span> = <span class="string">idWorker.nextId();</span></span></span><br><span class="line"><span class="tag">        <span class="attr">System.out.println</span>(<span class="attr">id</span>);</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag">    <span class="attr">System.out.println</span>((<span class="attr">System.nanoTime</span>()<span class="attr">-startTime</span>)/<span class="attr">1000000</span>+"<span class="attr">ms</span>");</span></span><br><span class="line"><span class="tag">}</span></span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      分布式自增ID算法---雪花算法
    
    </summary>
    
    
      <category term="J-Tools" scheme="https://www.zhuqiaolun.com/categories/J-Tools/"/>
    
    
      <category term="Snowflake" scheme="https://www.zhuqiaolun.com/tags/Snowflake/"/>
    
  </entry>
  
  <entry>
    <title>Go-FastDfs 工具类</title>
    <link href="https://www.zhuqiaolun.com/2021/11/1636190973137/1636190973137/"/>
    <id>https://www.zhuqiaolun.com/2021/11/1636190973137/1636190973137/</id>
    <published>2021-11-06T09:29:33.000Z</published>
    <updated>2021-11-06T09:42:55.682Z</updated>
    
    <content type="html"><![CDATA[<p><a href="/2021/05/1620815885110/1620815885110/">安装</a></p><h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>okhttp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="上传"><a href="#上传" class="headerlink" title="上传"></a>上传</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line">import com.alibaba.fastjson.JSONObject;</span><br><span class="line">import okhttp3.*;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * author ：demon</span><br><span class="line"> * date ：2021 2021/5/26 11:36</span><br><span class="line"> * desc ：GoFast工具类</span><br><span class="line"> */</span><br><span class="line">public class GoFastFileService {</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    public GoFastFileResult upload(String url, String scene, String fileName, byte[] bytes) throws Exception {</span><br><span class="line">        MultipartBody multipartBody = new MultipartBody.Builder().</span><br><span class="line">                setType(MultipartBody.FORM)</span><br><span class="line">                .addFormDataPart("file", fileName, RequestBody.create(MediaType.parse("multipart/form-data;charset=utf-8"), bytes))</span><br><span class="line">                .addFormDataPart("output", "json")</span><br><span class="line">                .addFormDataPart("scene", scene)</span><br><span class="line">                .build();</span><br><span class="line">        try {</span><br><span class="line">            GoFastFileResult goFastFileResult = new GoFastFileResult();</span><br><span class="line">            Request request = new Request.Builder().url(url).post(multipartBody).build();</span><br><span class="line">            Response response = new OkHttpClient().newCall(request).execute();</span><br><span class="line">            if (response.isSuccessful()) {</span><br><span class="line">                ResponseBody body = response.body();</span><br><span class="line">                if (body != null) {</span><br><span class="line">                    String result = body.string();</span><br><span class="line">                    System.out.println(result);</span><br><span class="line">                    JSONObject jsonObject = JSON.parseObject(result);</span><br><span class="line">                    if(String.valueOf(jsonObject.get("status")).equals("fail")){</span><br><span class="line">                        throw new Exception("上传文件异常:"+ jsonObject.get("message"));</span><br><span class="line">                    } else {</span><br><span class="line">                        goFastFileResult.setUrl(String.valueOf(jsonObject.get("url")));</span><br><span class="line">                        goFastFileResult.setMd5(String.valueOf(jsonObject.get("md5")));</span><br><span class="line">                        goFastFileResult.setPath(String.valueOf(jsonObject.get("path")));</span><br><span class="line">                        goFastFileResult.setDomain(String.valueOf(jsonObject.get("domain")));</span><br><span class="line">                        goFastFileResult.setScene(String.valueOf(jsonObject.get("scene")));</span><br><span class="line">                        goFastFileResult.setSize(Long.parseLong(String.valueOf(jsonObject.get("size"))));</span><br><span class="line">                        goFastFileResult.setMtime(Long.parseLong(String.valueOf(jsonObject.get("mtime"))));</span><br><span class="line">                        goFastFileResult.setScenes(String.valueOf(jsonObject.get("scenes")));</span><br><span class="line">                        goFastFileResult.setRetmsg(String.valueOf(jsonObject.get("retmsg")));</span><br><span class="line">                        goFastFileResult.setRetcode(String.valueOf(jsonObject.get("retcode")).equals("0"));</span><br><span class="line">                        goFastFileResult.setSrc(String.valueOf(jsonObject.get("src")));</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            return goFastFileResult;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            log.error("上传文件到影像服务器异常", e);</span><br><span class="line">            throw new Exception("上传文件异常",e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>返回值的实体类</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * author ：demon</span><br><span class="line"> * date ：2021 2021/5/26 13:23</span><br><span class="line"> * desc ：GoFastFile 结果返回映射</span><br><span class="line"> */</span><br><span class="line">public class GoFastFileResult implements Serializable {</span><br><span class="line"></span><br><span class="line">    private String url;</span><br><span class="line">    private String md5;</span><br><span class="line">    private String path;</span><br><span class="line">    private String domain;</span><br><span class="line">    private String scene;</span><br><span class="line">    private long size;</span><br><span class="line">    private long mtime;</span><br><span class="line">    private String scenes;</span><br><span class="line">    private String retmsg;</span><br><span class="line">    private Boolean retcode;</span><br><span class="line">    private String src;</span><br><span class="line"></span><br><span class="line">    public String getUrl() {</span><br><span class="line">        return url;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setUrl(String url) {</span><br><span class="line">        this.url = url;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getMd5() {</span><br><span class="line">        return md5;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setMd5(String md5) {</span><br><span class="line">        this.md5 = md5;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getPath() {</span><br><span class="line">        return path;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setPath(String path) {</span><br><span class="line">        this.path = path;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getDomain() {</span><br><span class="line">        return domain;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setDomain(String domain) {</span><br><span class="line">        this.domain = domain;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getScene() {</span><br><span class="line">        return scene;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setScene(String scene) {</span><br><span class="line">        this.scene = scene;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public long getSize() {</span><br><span class="line">        return size;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setSize(long size) {</span><br><span class="line">        this.size = size;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public long getMtime() {</span><br><span class="line">        return mtime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setMtime(long mtime) {</span><br><span class="line">        this.mtime = mtime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getScenes() {</span><br><span class="line">        return scenes;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setScenes(String scenes) {</span><br><span class="line">        this.scenes = scenes;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getRetmsg() {</span><br><span class="line">        return retmsg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setRetmsg(String retmsg) {</span><br><span class="line">        this.retmsg = retmsg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public Boolean getRetcode() {</span><br><span class="line">        return retcode;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setRetcode(Boolean retcode) {</span><br><span class="line">        this.retcode = retcode;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public String getSrc() {</span><br><span class="line">        return src;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setSrc(String src) {</span><br><span class="line">        this.src = src;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Go-FastDfs
    
    </summary>
    
    
      <category term="J-Tools" scheme="https://www.zhuqiaolun.com/categories/J-Tools/"/>
    
    
      <category term="Go-FastDfs" scheme="https://www.zhuqiaolun.com/tags/Go-FastDfs/"/>
    
  </entry>
  
  <entry>
    <title>接口测试 - 常用测试点有哪些</title>
    <link href="https://www.zhuqiaolun.com/2021/09/1632971629467/1632971629467/"/>
    <id>https://www.zhuqiaolun.com/2021/09/1632971629467/1632971629467/</id>
    <published>2021-09-30T03:13:49.000Z</published>
    <updated>2021-09-30T03:27:49.430Z</updated>
    
    <content type="html"><![CDATA[<h3 id="功能方面"><a href="#功能方面" class="headerlink" title="功能方面"></a>功能方面</h3><p>接口的功能是否正确实现了？接口是否按照设计文档中来实现</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">兼容性测试： </span><br><span class="line">    比如说今天接口进行了调整，但是前端没有进行变更，这时候需要验证新的接口是否满足旧的调用方式</span><br><span class="line"></span><br><span class="line">错误码测试： </span><br><span class="line">    通用的错误码与业务错误码是否能够清晰的说明调用问题，错误码是否能够尽可能的全的覆盖所有的情况</span><br><span class="line"></span><br><span class="line">返回值测试： </span><br><span class="line">    返回值除了内容需要是正确的，还需要类型也是正确的，保证调用方拿到这些参数能够正确的解析</span><br><span class="line"></span><br><span class="line">参数测试</span><br><span class="line">    边界值、等价类等，</span><br><span class="line">    比如username参数写为了user，那么这就不符合，因为接口文档在整个开发中都需要使用，所以接口实际的设计要与接口设计文档中保持一致</span><br><span class="line"></span><br><span class="line">json格式测试：</span><br><span class="line">    通常我们的接口一般设计的都是传递json串，那么就需要去测试 </span><br><span class="line">    如果传递非json的情况，这时候程序会不会正确的处理，返回相应的 error code</span><br><span class="line"></span><br><span class="line">默认值测试： </span><br><span class="line">    很多情况一些非必填的参数会有默认值，比如说一个查询的接口，参数count为返回查询的结果数量， 默认为10，</span><br><span class="line">    那么就应该有一条case来测试，当然前置条件是数据库里面必须要存在这样的数据超过10条。</span><br></pre></td></tr></tbody></table></figure></div><h3 id="逻辑方面"><a href="#逻辑方面" class="headerlink" title="逻辑方面"></a>逻辑方面</h3><p>是否有依赖业务，比如查看订单，是需要用户首先登录的，所以肯定要保证登录了或有相应的cookie</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">业务测试：</span><br><span class="line">    传递正确的参数，接口对数据库进行查询的操作，需要去验证数据库查询是否正确，</span><br><span class="line">    接口对数据库进行增删改的操作，也需要看数据库是否同步进行了这些操作，</span><br></pre></td></tr></tbody></table></figure></div><h3 id="异常方面"><a href="#异常方面" class="headerlink" title="异常方面"></a>异常方面</h3><p>异常分为两类：参数异常和数据异常</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">参数异常：</span><br><span class="line">    关键字参数：将参数写为开发语言中的关键字</span><br><span class="line">    参数为空：比如去掉了username参数</span><br><span class="line">    多或少参数：多或者少参数的验证，现在还不确定如果一个接口多了参数如果没有报错是否是合理的，或者是否需要优化</span><br><span class="line">    错误参数：比如将username参数写为了user等看是否能返回相应的error?code</span><br><span class="line">    </span><br><span class="line">数据异常：</span><br><span class="line">    关键字数据：将参数的值填为开发语言中的关键字</span><br><span class="line">    数据为空：将参数的额值填为空</span><br><span class="line">    长度不一致：因为数据库中每个字段都设置有字段长度，填写不符合的长度进行验证</span><br><span class="line">    错误数据：就是将参数的值任意填写，或填写不存在的数值</span><br><span class="line">    </span><br><span class="line">异常类型： </span><br><span class="line">    比如count参数，这个参数的类型一定是可以转换为int类型的，</span><br><span class="line">    这时候我们需要测试如果传的一些不可以转换为int类型值来测试代码是否加入</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      接口测试 - 常用测试点有哪些
    
    </summary>
    
    
      <category term="论扩" scheme="https://www.zhuqiaolun.com/categories/%E8%AE%BA%E6%89%A9/"/>
    
    
      <category term="接口" scheme="https://www.zhuqiaolun.com/tags/%E6%8E%A5%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>Java面试题</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1626834884475/1626834884475/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1626834884475/1626834884475/</id>
    <published>2021-07-21T02:34:44.000Z</published>
    <updated>2021-09-30T03:28:46.611Z</updated>
    
    <content type="html"><![CDATA[<h3 id="基础部门"><a href="#基础部门" class="headerlink" title="基础部门"></a>基础部门</h3><details><summary>1.面向对象的特征有哪些方面？</summary>    <div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Java面向对象的几个特征分别为：封装，继承，多态。</span><br><span class="line"></span><br><span class="line">封装：</span><br><span class="line">    是将代码及其处理的数据绑定在一起的一种编程机制。</span><br><span class="line">    该机制保证了程序和数据都不受外部干扰且不被误用。</span><br><span class="line"></span><br><span class="line">继承：</span><br><span class="line">    是指子类拥有父类的全部特征和行为。</span><br><span class="line">    这是类之间的一种关系，Java 只支持单继承。</span><br><span class="line"></span><br><span class="line">多态：</span><br><span class="line">    面向对象的多态性，即“一个接口，多个方法”。</span><br><span class="line">    多态性体现在父类中定义的属性和方法被子类继承后，可以具有不同的属性或表现方式。</span><br><span class="line">    多态性允许一个接口被多个同类使用，弥补了单继承的不足。</span><br></pre></td></tr></tbody></table></figure></div></details><details><summary>2.访问修饰符public,private,protected,以及不写（默认default）时的区别？</summary>    <div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public：     当前类（√）  同包（√）   子类（√）   其他包（√） </span><br><span class="line">private：    当前类（√）  同包（√）   子类（√）   其他包（×）</span><br><span class="line">protected：  当前类（√）  同包（√）   子类（×）   其他包（×）</span><br><span class="line">default：    当前类（√）  同包（×）   子类（×）   其他包（×）</span><br></pre></td></tr></tbody></table></figure></div></details><details><summary>3.String 是最基本的数据类型吗？</summary>    <div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">不是。</span><br><span class="line">Java中的基本数据类型只有8个：byte、short、int、long、float、double、char、boolean；</span><br><span class="line">除了基本类型（primitive type），剩下的都是引用类型（reference type），</span><br><span class="line">Java 5以后引入的枚举类型也算是一种比较特殊的引用类型。</span><br></pre></td></tr></tbody></table></figure></div></details><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Java面试题
    
    </summary>
    
    
      <category term="Java" scheme="https://www.zhuqiaolun.com/categories/Java/"/>
    
    
      <category term="Java" scheme="https://www.zhuqiaolun.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearch安装head插件</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1626760500688/1626760500688/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1626760500688/1626760500688/</id>
    <published>2021-07-20T05:55:00.000Z</published>
    <updated>2021-07-20T06:37:10.744Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ElasticSearch-head页面介绍"><a href="#ElasticSearch-head页面介绍" class="headerlink" title="ElasticSearch-head页面介绍"></a>ElasticSearch-head页面介绍</h3><p>在登陆和访问head插件地址和ElasticSearch前需要事先在服务器上安装和配置好ElasticSearch以及head插件。<br>安装完后，默认head插件的web端口为9100，ElasticSearch服务的端口为9200，使用浏览器访问head地址，如 <a href="http://localhost:9100/，" target="_blank" rel="noopener">http://localhost:9100/，</a><br>推荐使用Chrome浏览器，head插件对Chrome浏览器兼容更佳。<br>进入head页面后将ElasticSearch连接输入框中填写正确的ElasticSearch服务地址，如 <a href="http://localhost:9200/。" target="_blank" rel="noopener">http://localhost:9200/。</a></p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener">网址</a> <a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener">https://github.com/mobz/elasticsearch-head</a><br><a href="https://github.com/mobz/elasticsearch-head/archive/refs/heads/master.zip" target="_blank" rel="noopener">下载</a> <a href="https://github.com/mobz/elasticsearch-head/archive/refs/heads/master.zip" target="_blank" rel="noopener">https://github.com/mobz/elasticsearch-head/archive/refs/heads/master.zip</a></p><p>解压<br><img src="/2021/07/1626760500688/1626760500688/20210720140821.png" alt="20210720140821"></p><p>进入head文件夹下，执行命令：npm install (此处是为安装进行安装pathomjs)<br><img src="/2021/07/1626760500688/1626760500688/20210720141653.png" alt="20210720141653"><br><img src="/2021/07/1626760500688/1626760500688/20210720142330.png" alt="20210720142330"></p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>安装完成之后 npm run start 启动head插件<br><img src="/2021/07/1626760500688/1626760500688/20210720142519.png" alt="20210720142519"></p><p>访问：<a href="http://localhost:9100/" target="_blank" rel="noopener">http://localhost:9100/</a><br><img src="/2021/07/1626760500688/1626760500688/20210720142559.png" alt="20210720142559"></p><h3 id="修改es配置"><a href="#修改es配置" class="headerlink" title="修改es配置"></a>修改es配置</h3><p>修改es使用的参数.编辑目录下的config\elasticsearch.yml文件,</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 增加新的参数，这样head插件可以访问es</span><br><span class="line">http.cors.enabled: true </span><br><span class="line">http.cors.allow-origin: "*"</span><br></pre></td></tr></tbody></table></figure></div><p>修改完配置将es重启,浏览器访问 <a href="http://localhost:9100" target="_blank" rel="noopener">http://localhost:9100</a><br><img src="/2021/07/1626760500688/1626760500688/20210720143422.png" alt="20210720143422"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      ElasticSearch安装head插件
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="https://www.zhuqiaolun.com/categories/ElasticSearch/"/>
    
    
      <category term="ElasticSearch-Plug" scheme="https://www.zhuqiaolun.com/tags/ElasticSearch-Plug/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearch的安装</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1626758495025/1626758495025/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1626758495025/1626758495025/</id>
    <published>2021-07-20T05:21:35.000Z</published>
    <updated>2021-07-20T07:11:45.364Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><p>ElasticSearch是基于lucence开发的，也就是运行需要java jdk支持，所以要先安装JAVA环境。<br>由于ElasticSearch 5.x 往后依赖于JDK 1.8的，所以现在我们下载JDK 1.8或者更高版本。<br>下载JDK1.8,下载完成后<a href="/2020/05/1590236390000/1590236390000/">安装</a></p><p>如若不安装JDK，可使用ElasticSearch的自带的JDK <a href="#使用自带的JDK">使用自带的JDK</a></p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">官网</a><br><img src="/2021/07/1626758495025/1626758495025/20210720132838.png" alt="20210720132838"></p><p>解压<br><img src="/2021/07/1626758495025/1626758495025/20210720133515.png" alt="20210720133515"></p><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p>进入bin目录下,双击执行elasticsearch.bat<br><img src="/2021/07/1626758495025/1626758495025/20210720133655.png" alt="20210720133655"></p><p>查看<br>第一次启动：<br><img src="/2021/07/1626758495025/1626758495025/20210720134124.png" alt="20210720134124"></p><p>第N+1次启动：<br><img src="/2021/07/1626758495025/1626758495025/20210720143148.png" alt="20210720143148"></p><p>浏览器访问：<a href="http://localhost:9200" target="_blank" rel="noopener">http://localhost:9200</a><br><img src="/2021/07/1626758495025/1626758495025/20210720134200.png" alt="20210720134200"></p><h2 id="配置远程访问"><a href="#配置远程访问" class="headerlink" title="配置远程访问"></a>配置远程访问</h2><p>修改es使用的参数.编辑目录下的config\elasticsearch.yml文件,</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">network.host: 0.0.0.0  </span><br><span class="line">http.port: 9200</span><br><span class="line"></span><br><span class="line">cluster.initial_master_nodes: ["node-1"]</span><br></pre></td></tr></tbody></table></figure></div><p><img src="/2021/07/1626758495025/1626758495025/20210720150202.png" alt="20210720150202"></p><h2 id="使用自带的JDK"><a href="#使用自带的JDK" class="headerlink" title="使用自带的JDK"></a>使用自带的JDK</h2><p>在bin目录下找到elasticsearch-env.bat并打开，加入你es7本身自带的jdk路径：<br>rem 配置es自己的jdk<br>set ES_JAVA_HOME=D:\services\elasticsearch-7.13.3\jdk<br><img src="/2021/07/1626758495025/1626758495025/20210720151122.png" alt="20210720151122"></p><h3 id="ElasticSearch安装为Windows服务"><a href="#ElasticSearch安装为Windows服务" class="headerlink" title="ElasticSearch安装为Windows服务"></a>ElasticSearch安装为Windows服务</h3><p>bin目录下有一个文件 elasticsearch-service.bat</p><p>执行: elasticsearch-service.bat install 即可安装为服务</p><p>安装ElasticSearch服务：</p><blockquote><p>elasticsearch-service.bat install</p></blockquote><p>删除已安装的ElasticSearch服务（如果启动则停止服务）</p><blockquote><p>elasticsearch-service.bat remove</p></blockquote><p>启动ElasticSearch服务（如果已安装）</p><blockquote><p>elasticsearch-service.bat start</p></blockquote><p>停止ElasticSearch服务（如果已安装）</p><blockquote><p>elasticsearch-service.bat stop</p></blockquote><p>启动GUI来管理已安装的服务</p><blockquote><p>elasticsearch-service.bat manager</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      ElasticSearch，Windows，Linux 的安装
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="https://www.zhuqiaolun.com/categories/ElasticSearch/"/>
    
    
      <category term="ElasticSearch" scheme="https://www.zhuqiaolun.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>Freemarker 封装工具类</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1625196322877/1625196322877/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1625196322877/1625196322877/</id>
    <published>2021-07-02T03:25:22.000Z</published>
    <updated>2021-11-06T09:24:10.596Z</updated>
    
    <content type="html"><![CDATA[<p><a href="/2020/08/1597309130215/1597309130215/">配置</a></p><p>FreemarkerService：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * className    FreemarkerService</span><br><span class="line"> * author       demon</span><br><span class="line"> * createTime   2021/5/20 17:40</span><br><span class="line"> * description  生成静态页面service</span><br><span class="line"> */</span><br><span class="line">public interface FreemarkerService {</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 生成静态页面</span><br><span class="line">     *</span><br><span class="line">     * @param ftlName 模板名称</span><br><span class="line">     * @param params  数据模型</span><br><span class="line">     * @param outFile 输出文件</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    boolean createStaticHtml(String ftlName, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params, File outFile);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 生成静态数据</span><br><span class="line">     *</span><br><span class="line">     * @param ftlName 模板名称</span><br><span class="line">     * @param params  数据模型</span><br><span class="line">     * @return 返回</span><br><span class="line">     * @throws Exception 异常</span><br><span class="line">     */</span><br><span class="line">    String createStaticData(String ftlName, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 渲染静态数据</span><br><span class="line">     *</span><br><span class="line">     * @param ftlName 模板名称 - 自定义(随便一个值都行)</span><br><span class="line">     * @param ftlStr 模板字符串 - 内容</span><br><span class="line">     * @param params  数据模型</span><br><span class="line">     * @return 返回</span><br><span class="line">     * @throws Exception 异常</span><br><span class="line">     */</span><br><span class="line">    String createStaticData(String ftlName,String ftlStr, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 渲染静态数据</span><br><span class="line">     *</span><br><span class="line">     * @param ftlName 模板名称 - 自定义(随便一个值都行)</span><br><span class="line">     * @param inputStream 模板字符串 - 内容 （文件流）</span><br><span class="line">     *                    resources目录下的文件 如：</span><br><span class="line">     *                    InputStream inputStream = xxx.class.getResourceAsStream("/ftl/example.ftl");</span><br><span class="line">     * @param params  数据模型</span><br><span class="line">     * @return 返回</span><br><span class="line">     * @throws Exception 异常</span><br><span class="line">     */</span><br><span class="line">    String createStaticData(String ftlName, InputStream inputStream, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import freemarker.template.Configuration;</span><br><span class="line">import freemarker.template.Template;</span><br><span class="line">import freemarker.template.TemplateException;</span><br><span class="line">import org.apache.commons.io.FileUtils;</span><br><span class="line">import org.apache.commons.io.IOUtils;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import org.springframework.ui.freemarker.FreeMarkerTemplateUtils;</span><br><span class="line"></span><br><span class="line">import javax.annotation.Resource;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * className    FreemarkerServiceImpl</span><br><span class="line"> * author       demon</span><br><span class="line"> * createTime   2021/5/20 17:40</span><br><span class="line"> */</span><br><span class="line">@Service</span><br><span class="line">public class FreemarkerServiceImpl implements FreemarkerService {</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private Configuration configuration;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean createStaticHtml(String ftlName, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params, File outFile) {</span><br><span class="line">        InputStream inputStream = null;</span><br><span class="line">        FileOutputStream fileOutputStream = null;</span><br><span class="line">        try {</span><br><span class="line">            //获取模板</span><br><span class="line">            Template template = configuration.getTemplate(ftlName);</span><br><span class="line">            // 静态化页面内容</span><br><span class="line">            String content = FreeMarkerTemplateUtils.processTemplateIntoString(template, params);</span><br><span class="line">            inputStream = IOUtils.toInputStream(content, "UTF-8");</span><br><span class="line">            // 输出文件</span><br><span class="line">            FileUtils.forceMkdirParent(outFile);</span><br><span class="line">            fileOutputStream = new FileOutputStream(outFile);</span><br><span class="line">            IOUtils.copy(inputStream, fileOutputStream);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (IOException | TemplateException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        } finally {</span><br><span class="line">            // 关闭流</span><br><span class="line">            if (inputStream != null) {</span><br><span class="line">                try {</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                } catch (IOException e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                } finally {</span><br><span class="line">                    if (fileOutputStream != null) {</span><br><span class="line">                        try {</span><br><span class="line">                            fileOutputStream.close();</span><br><span class="line">                        } catch (IOException e) {</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String createStaticData(String ftlName, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception {</span><br><span class="line">        try {</span><br><span class="line">            //获取模板</span><br><span class="line">            Template template = configuration.getTemplate(ftlName);</span><br><span class="line">            // 静态化数据内容</span><br><span class="line">            return FreeMarkerTemplateUtils.processTemplateIntoString(template, params);</span><br><span class="line">        } catch (IOException | TemplateException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            throw new Exception(e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String createStaticData(String ftlName, String templateStr, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception {</span><br><span class="line">        try {</span><br><span class="line">            //创建模板</span><br><span class="line">            Template template = new Template(ftlName, templateStr, configuration);</span><br><span class="line">            // 渲染静态数据内容</span><br><span class="line">            return FreeMarkerTemplateUtils.processTemplateIntoString(template, params);</span><br><span class="line">        } catch (IOException | TemplateException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            throw new Exception(e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String createStaticData(String ftlName, InputStream inputStream, Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params) throws Exception {</span><br><span class="line">        try {</span><br><span class="line">            String ftlStr = IOUtils.toString(inputStream, "utf-8");</span><br><span class="line">            //创建模板</span><br><span class="line">            Template template = new Template(ftlName, ftlStr, configuration);</span><br><span class="line">            // 渲染静态数据内容</span><br><span class="line">            return FreeMarkerTemplateUtils.processTemplateIntoString(template, params);</span><br><span class="line">        } catch (IOException | TemplateException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            throw new Exception(e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>模板：<br>example.ftl：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  "username": "${username}"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>示例1：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Test</span><br><span class="line">void 测试模板_静态页面() {</span><br><span class="line">    String ftlName = "example.ftl";</span><br><span class="line">    Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params = new HashMap<span class="tag">&lt;&gt;</span>();</span><br><span class="line">    params.put("username", "测试888");</span><br><span class="line">    System.out.println(JSONObject.toJSONString(params));</span><br><span class="line">    File outFile = new File("d:/test/page/test.html");</span><br><span class="line">    System.out.println(freemarkerService.createStaticHtml(ftlName, params, outFile));</span><br><span class="line">}</span><br><span class="line">    </span><br><span class="line">@Test</span><br><span class="line">void 测试模板_渲染数据1() {</span><br><span class="line">    String ftlName = "example.ftl";</span><br><span class="line">    String templateValue = "hello,${username}";</span><br><span class="line">    Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params = new HashMap<span class="tag">&lt;&gt;</span>();</span><br><span class="line">    params.put("username","测试888");</span><br><span class="line">    try {</span><br><span class="line">        System.out.println(freemarkerService.createStaticData(ftlName,params));</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">void 测试模板_渲染数据2() {</span><br><span class="line">    String ftlName = "example.ftl";</span><br><span class="line">    String templateStr = "hello,${username}";</span><br><span class="line">    Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params = new HashMap<span class="tag">&lt;&gt;</span>();</span><br><span class="line">    params.put("username","测试888");</span><br><span class="line">    try {</span><br><span class="line">        System.out.println(freemarkerService.createStaticData(ftlName,templateStr,params));</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">void 测试模板_渲染数据3() {</span><br><span class="line">    String ftlName = "example.ftl";</span><br><span class="line">    String templateValue = "hello,${username}";</span><br><span class="line">    Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> params = new HashMap<span class="tag">&lt;&gt;</span>();</span><br><span class="line">    params.put("username", "测试888");</span><br><span class="line">    System.out.println(JSONObject.toJSONString(params));</span><br><span class="line">    try {</span><br><span class="line">        InputStream inputStream = xxx.class.getResourceAsStream("/ftl/example.ftl");</span><br><span class="line">        System.out.println(freemarkerService.createStaticData(ftlName, inputStream, params));</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>运行结果：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hello,测试888</span><br><span class="line">{</span><br><span class="line">  "username": "测试888"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Freemarker 封装工具类
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://www.zhuqiaolun.com/categories/SpringBoot/"/>
    
    
      <category term="Freemarker" scheme="https://www.zhuqiaolun.com/tags/Freemarker/"/>
    
  </entry>
  
  <entry>
    <title>RedisTemplate 封装工具类</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1625194461536/1625194461536/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1625194461536/1625194461536/</id>
    <published>2021-07-02T02:54:21.000Z</published>
    <updated>2021-07-02T05:13:56.012Z</updated>
    
    <content type="html"><![CDATA[<p><a href="/2020/11/1605606341401/1605606341401/">配置</a></p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">import org.springframework.util.CollectionUtils;</span><br><span class="line"></span><br><span class="line">import javax.annotation.Resource;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Set;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author: Demon</span><br><span class="line"> * @date 2019/8/19 14:34</span><br><span class="line"> * @description:  封装redisUtil类</span><br><span class="line"> */</span><br><span class="line">@SuppressWarnings("ConstantConditions")</span><br><span class="line">@Slf4j</span><br><span class="line">@Component</span><br><span class="line">public class RedisTemplateUtil {</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private RedisTemplate<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> redisTemplate;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 指定缓存失效时间</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param time 时间(秒)</span><br><span class="line">     */</span><br><span class="line">    public boolean expire(String key, long time) {</span><br><span class="line">        try {</span><br><span class="line">            if (time &gt; 0) {</span><br><span class="line">                redisTemplate.expire(key, time, TimeUnit.SECONDS);</span><br><span class="line">            }</span><br><span class="line">            log.info("指定缓存失效时间成功，key:{}, time:{}", key, time);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            log.info("指定缓存失效时间错误，key:{}, time:{}", key, time);</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据key 获取过期时间</span><br><span class="line">     * @param key 键 不能为null</span><br><span class="line">     * @return 时间(秒) 返回0代表为永久有效</span><br><span class="line">     */</span><br><span class="line">    @SuppressWarnings("ConstantConditions")</span><br><span class="line">    public long getExpire(String key) {</span><br><span class="line">        log.info("获取过期时间，key:{}", key);</span><br><span class="line">        return redisTemplate.getExpire(key, TimeUnit.SECONDS);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 判断key是否存在</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @return true 存在 false不存在</span><br><span class="line">     */</span><br><span class="line">    public boolean hasKey(String key) {</span><br><span class="line">        try {</span><br><span class="line">            log.info("判断key是否存在，key:{}", key);</span><br><span class="line">            return redisTemplate.hasKey(key);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            log.info("判断key是否存在error，key:{}", key);</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除缓存</span><br><span class="line">     * @param key 可以传一个值 或多个</span><br><span class="line">     */</span><br><span class="line">    public void del(String... key) {</span><br><span class="line">        if (key != null &amp;&amp; key.length &gt; 0) {</span><br><span class="line">            if (key.length == 1) {</span><br><span class="line">                redisTemplate.delete(key[0]);</span><br><span class="line">            } else {</span><br><span class="line">                redisTemplate.delete(CollectionUtils.arrayToList(key));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 普通缓存获取</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @return 值</span><br><span class="line">     */</span><br><span class="line">    public Object get(String key) {</span><br><span class="line">        redisTemplate.getConnectionFactory().getConnection();</span><br><span class="line">        log.info("获取缓存, key:{}", key);</span><br><span class="line">        return key == null ? null : redisTemplate.opsForValue().get(key);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 普通缓存放入</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @return true成功 false失败</span><br><span class="line">     */</span><br><span class="line">    public boolean set(String key, Object value) {</span><br><span class="line">        try {</span><br><span class="line">            System.out.println(redisTemplate.getConnectionFactory().getConnection());</span><br><span class="line">            redisTemplate.opsForValue().set(key, value);</span><br><span class="line">            log.info("保存缓存, key:{}, value:{}", key, value);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 普通缓存放入并设置时间</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @param time 时间(秒) time要大于0 如果time小于等于0 将设置无限期</span><br><span class="line">     * @return true成功 false 失败</span><br><span class="line">     */</span><br><span class="line">    public boolean set(String key, Object value, long time) {</span><br><span class="line">        try {</span><br><span class="line">            if (time &gt; 0) {</span><br><span class="line">                redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);</span><br><span class="line">            } else {</span><br><span class="line">                set(key, value);</span><br><span class="line">            }</span><br><span class="line">            log.info("保存缓存并设置时间, key:{}, value:{}, time:{}", key, value, time);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 递增</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param delta 要增加几(大于0)</span><br><span class="line">     */</span><br><span class="line">    public long incr(String key, long delta) {</span><br><span class="line">        if (delta <span class="tag">&lt; <span class="attr">0</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">throw</span> <span class="attr">new</span> <span class="attr">RuntimeException</span>("递增因子必须大于<span class="attr">0</span>");</span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">        <span class="attr">return</span> <span class="attr">redisTemplate.opsForValue</span>()<span class="attr">.increment</span>(<span class="attr">key</span>, <span class="attr">delta</span>);</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    /**</span></span><br><span class="line"><span class="tag">     * 递减</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">key</span> 键</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">delta</span> 要减少几(小于<span class="attr">0</span>)</span></span><br><span class="line"><span class="tag">     * @<span class="attr">return</span> 值</span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">public</span> <span class="attr">long</span> <span class="attr">decr</span>(<span class="attr">String</span> <span class="attr">key</span>, <span class="attr">long</span> <span class="attr">delta</span>) {</span></span><br><span class="line">        if (delta &lt; 0) {</span><br><span class="line">            throw new RuntimeException("递减因子必须大于0");</span><br><span class="line">        }</span><br><span class="line">        return redisTemplate.opsForValue().increment(key, -delta);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * HashGet</span><br><span class="line">     * @param key 键 不能为null</span><br><span class="line">     * @param item 项 不能为null</span><br><span class="line">     * @return 值</span><br><span class="line">     */</span><br><span class="line">    public Object hget(String key, String item) {</span><br><span class="line">        return redisTemplate.opsForHash().get(key, item);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取hashKey对应的所有键值</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @return 对应的多个键值</span><br><span class="line">     */</span><br><span class="line">    public Map<span class="tag">&lt;<span class="name">Object,</span> <span class="attr">Object</span>&gt;</span> hmget(String key) {</span><br><span class="line">        return redisTemplate.opsForHash().entries(key);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * HashSet</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param map 对应多个键值</span><br><span class="line">     * @return true 成功 false 失败</span><br><span class="line">     */</span><br><span class="line">    public boolean hmset(String key, Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> map) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * HashSet 并设置时间</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param map 对应多个键值</span><br><span class="line">     * @param time 时间(秒)</span><br><span class="line">     * @return true成功 false失败</span><br><span class="line">     */</span><br><span class="line">    public boolean hmset(String key, Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> map, long time) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            if (time &gt; 0) {</span><br><span class="line">                expire(key, time);</span><br><span class="line">            }</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 向一张hash表中放入数据,如果不存在将创建</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param item 项</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @return true 成功 false失败</span><br><span class="line">     */</span><br><span class="line">    public boolean hset(String key, String item, Object value) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 向一张hash表中放入数据,如果不存在将创建</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param item 项</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @param time 时间(秒) 注意:如果已存在的hash表有时间,这里将会替换原有的时间</span><br><span class="line">     * @return true 成功 false失败</span><br><span class="line">     */</span><br><span class="line">    public boolean hset(String key, String item, Object value, long time) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            if (time &gt; 0) {</span><br><span class="line">                expire(key, time);</span><br><span class="line">            }</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除hash表中的值</span><br><span class="line">     * @param key 键 不能为null</span><br><span class="line">     * @param item 项 可以使多个 不能为null</span><br><span class="line">     */</span><br><span class="line">    public void hdel(String key, Object... item) {</span><br><span class="line">        redisTemplate.opsForHash().delete(key, item);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 判断hash表中是否有该项的值</span><br><span class="line">     * @param key 键 不能为null</span><br><span class="line">     * @param item 项 不能为null</span><br><span class="line">     * @return true 存在 false不存在</span><br><span class="line">     */</span><br><span class="line">    public boolean hHasKey(String key, String item) {</span><br><span class="line">        return redisTemplate.opsForHash().hasKey(key, item);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * hash递增 如果不存在,就会创建一个 并把新增后的值返回</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param item 项</span><br><span class="line">     * @param by 要增加几(大于0)</span><br><span class="line">     */</span><br><span class="line">    public double hincr(String key, String item, double by) {</span><br><span class="line">        return redisTemplate.opsForHash().increment(key, item, by);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * hash递减</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param item 项</span><br><span class="line">     * @param by 要减少记(小于0)</span><br><span class="line">     */</span><br><span class="line">    public double hdecr(String key, String item, double by) {</span><br><span class="line">        return redisTemplate.opsForHash().increment(key, item, -by);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据key获取Set中的所有值</span><br><span class="line">     * @param key 键</span><br><span class="line">     */</span><br><span class="line">    public Set<span class="tag">&lt;<span class="name">Object</span>&gt;</span> sGet(String key) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForSet().members(key);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return null;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据value从一个set中查询,是否存在</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @return true 存在 false不存在</span><br><span class="line">     */</span><br><span class="line">    public boolean sHasKey(String key, Object value) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 将数据放入set缓存</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param values 值 可以是多个</span><br><span class="line">     */</span><br><span class="line">    public long sSet(String key, Object... values) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForSet().add(key, values);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 将set数据放入缓存</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param time 时间(秒)</span><br><span class="line">     * @param values 值 可以是多个</span><br><span class="line">     */</span><br><span class="line">    public long sSetAndTime(String key, long time, Object... values) {</span><br><span class="line">        try {</span><br><span class="line">            Long count = redisTemplate.opsForSet().add(key, values);</span><br><span class="line">            if (time &gt; 0){</span><br><span class="line">                expire(key, time);</span><br><span class="line">            }</span><br><span class="line">            return count;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取set缓存的长度</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @return 值</span><br><span class="line">     */</span><br><span class="line">    @SuppressWarnings("ConstantConditions")</span><br><span class="line">    public long sGetSetSize(String key) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForSet().size(key);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 移除值为value的</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param values 值 可以是多个</span><br><span class="line">     * @return 移除的个数</span><br><span class="line">     */</span><br><span class="line">    public long setRemove(String key, Object... values) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForSet().remove(key, values);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取list缓存的内容</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param start 开始</span><br><span class="line">     * @param end 结束 0 到 -1代表所有值</span><br><span class="line">     */</span><br><span class="line">    public List<span class="tag">&lt;<span class="name">Object</span>&gt;</span> lGet(String key, long start, long end) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForList().range(key, start, end);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return null;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取list缓存的长度</span><br><span class="line">     * @param key 键</span><br><span class="line">     */</span><br><span class="line">    public long lGetListSize(String key) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForList().size(key);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 通过索引 获取list中的值</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param index 索引 index&gt;=0时， 0 表头，1 第二个元素，依次类推；index<span class="tag">&lt;<span class="name">0时，-1，表尾，-2倒数第二个元素，依次类推</span></span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">public</span> <span class="attr">Object</span> <span class="attr">lGetIndex</span>(<span class="attr">String</span> <span class="attr">key</span>, <span class="attr">long</span> <span class="attr">index</span>) {</span></span><br><span class="line"><span class="tag">        <span class="attr">try</span> {</span></span><br><span class="line"><span class="tag">            <span class="attr">return</span> <span class="attr">redisTemplate.opsForList</span>()<span class="attr">.index</span>(<span class="attr">key</span>, <span class="attr">index</span>);</span></span><br><span class="line"><span class="tag">        } <span class="attr">catch</span> (<span class="attr">Exception</span> <span class="attr">e</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">e.printStackTrace</span>();</span></span><br><span class="line"><span class="tag">            <span class="attr">return</span> <span class="attr">null</span>;</span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    /**</span></span><br><span class="line"><span class="tag">     * 将<span class="attr">list</span>放入缓存</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">key</span> 键</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">value</span> 值</span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">public</span> <span class="attr">boolean</span> <span class="attr">lSet</span>(<span class="attr">String</span> <span class="attr">key</span>, <span class="attr">Object</span> <span class="attr">value</span>) {</span></span><br><span class="line"><span class="tag">        <span class="attr">try</span> {</span></span><br><span class="line"><span class="tag">            <span class="attr">redisTemplate.opsForList</span>()<span class="attr">.rightPush</span>(<span class="attr">key</span>, <span class="attr">value</span>);</span></span><br><span class="line"><span class="tag">            <span class="attr">return</span> <span class="attr">true</span>;</span></span><br><span class="line"><span class="tag">        } <span class="attr">catch</span> (<span class="attr">Exception</span> <span class="attr">e</span>) {</span></span><br><span class="line"><span class="tag">            <span class="attr">e.printStackTrace</span>();</span></span><br><span class="line"><span class="tag">            <span class="attr">return</span> <span class="attr">false</span>;</span></span><br><span class="line"><span class="tag">        }</span></span><br><span class="line"><span class="tag">    }</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    /**</span></span><br><span class="line"><span class="tag">     * 将<span class="attr">list</span>放入缓存</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">key</span> 键</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">value</span> 值</span></span><br><span class="line"><span class="tag">     * @<span class="attr">param</span> <span class="attr">time</span> 时间(秒)</span></span><br><span class="line"><span class="tag">     */</span></span><br><span class="line"><span class="tag">    <span class="attr">public</span> <span class="attr">boolean</span> <span class="attr">lSet</span>(<span class="attr">String</span> <span class="attr">key</span>, <span class="attr">Object</span> <span class="attr">value</span>, <span class="attr">long</span> <span class="attr">time</span>) {</span></span><br><span class="line"><span class="tag">        <span class="attr">try</span> {</span></span><br><span class="line"><span class="tag">            <span class="attr">redisTemplate.opsForList</span>()<span class="attr">.rightPush</span>(<span class="attr">key</span>, <span class="attr">value</span>);</span></span><br><span class="line"><span class="tag">            <span class="attr">if</span> (<span class="attr">time</span> &gt;</span> 0){</span><br><span class="line">                expire(key, time);</span><br><span class="line">            }</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 将list放入缓存</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param value 值</span><br><span class="line">     */</span><br><span class="line">    public boolean lSet(String key, List<span class="tag">&lt;<span class="name">Object</span>&gt;</span> value) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 将list放入缓存</span><br><span class="line">     *</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param value 值</span><br><span class="line">     * @param time 时间(秒)</span><br><span class="line">     */</span><br><span class="line">    public boolean lSet(String key, List<span class="tag">&lt;<span class="name">Object</span>&gt;</span> value, long time) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            if (time &gt; 0){</span><br><span class="line">                expire(key, time);</span><br><span class="line">            }</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据索引修改list中的某条数据</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param index 索引</span><br><span class="line">     * @param value 值</span><br><span class="line">     */</span><br><span class="line">    public boolean lUpdateIndex(String key, long index, Object value) {</span><br><span class="line">        try {</span><br><span class="line">            redisTemplate.opsForList().set(key, index, value);</span><br><span class="line">            return true;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 移除N个值为value</span><br><span class="line">     * @param key 键</span><br><span class="line">     * @param count 移除多少个</span><br><span class="line">     * @param value 值</span><br><span class="line">     */</span><br><span class="line">    public long lRemove(String key, long count, Object value) {</span><br><span class="line">        try {</span><br><span class="line">            return redisTemplate.opsForList().remove(key, count, value);</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      RedisTemplate 封装工具类
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://www.zhuqiaolun.com/categories/SpringBoot/"/>
    
    
      <category term="RedisTemplate" scheme="https://www.zhuqiaolun.com/tags/RedisTemplate/"/>
    
  </entry>
  
  <entry>
    <title>RestTemplate 封装工具类</title>
    <link href="https://www.zhuqiaolun.com/2021/07/1625194440104/1625194440104/"/>
    <id>https://www.zhuqiaolun.com/2021/07/1625194440104/1625194440104/</id>
    <published>2021-07-02T02:54:00.000Z</published>
    <updated>2021-07-23T05:15:52.045Z</updated>
    
    <content type="html"><![CDATA[<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p><a href="/2020/11/1605079105126/1605079105126/">ApplicationContextHelper</a></p><p><a href="/2020/06/1592881660483/1592881660483/">RestTemplate配置</a></p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><blockquote><p>简单的 Get、Post 请求</p></blockquote><blockquote><p>自定义请求头的 Get、Post 请求</p></blockquote><blockquote><p>带参数的 Get(Query) 请求</p></blockquote><blockquote><p>带参数的 Post(Query/Body) 请求</p></blockquote><blockquote><p>可上传单个、多个文件的 Post 请求</p></blockquote><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">import org.springframework.http.HttpEntity;</span><br><span class="line">import org.springframework.http.HttpHeaders;</span><br><span class="line">import org.springframework.http.HttpMethod;</span><br><span class="line">import org.springframework.http.ResponseEntity;</span><br><span class="line">import org.springframework.util.LinkedMultiValueMap;</span><br><span class="line">import org.springframework.util.MultiValueMap;</span><br><span class="line">import org.springframework.web.client.RestTemplate;</span><br><span class="line">import org.springframework.web.util.UriComponentsBuilder;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * author ：demon</span><br><span class="line"> * date ：2021 2021/6/29 18:20</span><br><span class="line"> * desc ：RestTemplate 工具</span><br><span class="line"> */</span><br><span class="line">public class RestTemplateUtil {</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 自定义请求头</span><br><span class="line">     * 简单的 Get请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> simpleGet(HttpHeaders headers, String url) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);</span><br><span class="line">        //将请求头部和参数合成一个请求</span><br><span class="line">        HttpEntity<span class="php"><span class="meta">&lt;?</span>&gt; httpEntity = <span class="keyword">new</span> HttpEntity&lt;&gt;(headers);</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> restTemplate.exchange(builder.build().encode().toUri(), HttpMethod.GET, httpEntity, String<span class="class">.<span class="keyword">class</span>);</span></span></span><br><span class="line"><span class="php">    }</span></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 带参数 Get请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param params  参数</span><br><span class="line">     * @return 返回</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity&lt;String&gt; executeGetParam(HttpHeaders headers, String url, Map&lt;String, String&gt; params) {</span></span><br><span class="line"><span class="php">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate<span class="class">.<span class="keyword">class</span>);</span></span></span><br><span class="line"><span class="php">        headers.set(<span class="string">"Content-Type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span></span><br><span class="line"><span class="php">        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (params != <span class="keyword">null</span> &amp;&amp; params.size() &gt; <span class="number">0</span>) {</span></span><br><span class="line"><span class="php">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : params.entrySet()) {</span></span><br><span class="line"><span class="php">                builder.queryParam(entry.getKey(), entry.getValue());</span></span><br><span class="line"><span class="php">            }</span></span><br><span class="line"><span class="php">        }</span></span><br><span class="line"><span class="php">        <span class="comment">//将请求头部和参数合成一个请求</span></span></span><br><span class="line"><span class="php">        HttpEntity<span class="meta">&lt;?</span>&gt;</span> httpEntity = new HttpEntity<span class="tag">&lt;&gt;</span>(headers);</span><br><span class="line">        return restTemplate.exchange(builder.build().encode().toUri(), HttpMethod.GET, httpEntity, String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 自定义请求头</span><br><span class="line">     *  - Query</span><br><span class="line">     *  - Body</span><br><span class="line">     * 简单的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> simplePost(HttpHeaders headers, String url) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        //将请求头部和参数合成一个请求</span><br><span class="line">        HttpEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> httpEntity = new HttpEntity<span class="tag">&lt;&gt;</span>(null, headers);</span><br><span class="line">        return restTemplate.postForEntity(url, httpEntity, String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 带参数的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param params  参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostFromParam(HttpHeaders headers, String url, Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">String</span>&gt;</span> params) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        return restTemplate.postForEntity(url, getMultiValueMap(headers, null, params), String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 上传单个文件的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param file    参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostFromFile(HttpHeaders headers, String url, File file) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        List<span class="tag">&lt;<span class="name">File</span>&gt;</span> files = new ArrayList<span class="tag">&lt;&gt;</span>();</span><br><span class="line">        files.add(file);</span><br><span class="line">        return restTemplate.postForEntity(url, getMultiValueMap(headers, files, null), String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 上传多个文件的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param files   参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostFromFile(HttpHeaders headers, String url, List<span class="tag">&lt;<span class="name">File</span>&gt;</span> files) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        return restTemplate.postForEntity(url, getMultiValueMap(headers, files, null), String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 上传单个文件且带参数的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param file    参数</span><br><span class="line">     * @param params  参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostFromFileParam(HttpHeaders headers, String url, File file, Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">String</span>&gt;</span> params) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        List<span class="tag">&lt;<span class="name">File</span>&gt;</span> files = new ArrayList<span class="tag">&lt;&gt;</span>();</span><br><span class="line">        files.add(file);</span><br><span class="line">        return restTemplate.postForEntity(url, getMultiValueMap(headers, files, params), String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表单 - Query</span><br><span class="line">     * 上传多个文件且带参数的 Post 请求</span><br><span class="line">     *</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url     参数</span><br><span class="line">     * @param files   参数</span><br><span class="line">     * @param params  参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostFromFileParam(HttpHeaders headers, String url, List<span class="tag">&lt;<span class="name">File</span>&gt;</span> files, Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">String</span>&gt;</span> params) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        return restTemplate.postForEntity(url, getMultiValueMap(headers, files, params), String.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private static HttpEntity&lt;MultiValueMap&lt;String, Object&gt;&gt; getMultiValueMap(HttpHeaders headers, List&lt;File&gt; files, Map&lt;String, String&gt; params) {</span><br><span class="line">        MultiValueMap<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> multiValueMap = new LinkedMultiValueMap<span class="tag">&lt;&gt;</span>();</span><br><span class="line">        if (files != null &amp;&amp; files.size() &gt; 0) {</span><br><span class="line">            headers.set("Content-Type", "multipart/form-data");</span><br><span class="line">            for (File file : files) {</span><br><span class="line">                multiValueMap.add("file", new org.springframework.core.io.FileSystemResource(file));</span><br><span class="line">            }</span><br><span class="line">        } else {</span><br><span class="line">            headers.set("Content-Type", "application/x-www-form-urlencoded");</span><br><span class="line">        }</span><br><span class="line">        if (params != null &amp;&amp; params.size() &gt; 0) {</span><br><span class="line">            for (Map.Entry<span class="tag">&lt;<span class="name">String,</span> <span class="attr">String</span>&gt;</span> entry : params.entrySet()) {</span><br><span class="line">                multiValueMap.add(entry.getKey(), entry.getValue());</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return new HttpEntity<span class="tag">&lt;&gt;</span>(multiValueMap, headers);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Body请求 - Body</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url 参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostBody(HttpHeaders headers, String url) {</span><br><span class="line">        return executePostBodyParam(headers,url,null);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Body请求 - Body</span><br><span class="line">     * @param headers 参数</span><br><span class="line">     * @param url 参数</span><br><span class="line">     * @param str 参数</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    public static ResponseEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> executePostBodyParam(HttpHeaders headers, String url,String str) {</span><br><span class="line">        RestTemplate restTemplate = ApplicationContextHelper.getBean(RestTemplate.class);</span><br><span class="line">        headers.set("Content-Type", "application/json;charset=UTF-8");</span><br><span class="line">        HttpEntity<span class="tag">&lt;<span class="name">String</span>&gt;</span> httpEntity = new HttpEntity<span class="tag">&lt;&gt;</span>(str, headers);</span><br><span class="line">        return restTemplate.postForEntity(url, httpEntity, String.class);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      RestTemplate 封装工具类
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://www.zhuqiaolun.com/categories/SpringBoot/"/>
    
    
      <category term="RestTemplate" scheme="https://www.zhuqiaolun.com/tags/RestTemplate/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7防火墙操作命令</title>
    <link href="https://www.zhuqiaolun.com/2021/06/1624517875141/1624517875141/"/>
    <id>https://www.zhuqiaolun.com/2021/06/1624517875141/1624517875141/</id>
    <published>2021-06-24T06:57:55.000Z</published>
    <updated>2021-06-24T07:13:36.816Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>查看服务是否开机启动<br>systemctl is-enabled firewalld.service</p></blockquote><blockquote><p>查看已启动的服务列表<br>systemctl list-unit-files|grep enabled</p></blockquote><blockquote><p>查看启动失败的服务列表<br>systemctl –failed</p></blockquote><h3 id="firewalld的基本使用"><a href="#firewalld的基本使用" class="headerlink" title="firewalld的基本使用"></a>firewalld的基本使用</h3><blockquote><p>查看状态：<br>systemctl status firewalld </p></blockquote><blockquote><p>启动：<br>systemctl start firewalld</p></blockquote><blockquote><p>停止：<br>systemctl stop firewalld</p></blockquote><blockquote><p>禁止开机启动：<br>systemctl disable firewalld</p></blockquote><blockquote><p>启用开机启动：<br>systemctl enable firewalld</p></blockquote><h3 id="配置firewall-cmd"><a href="#配置firewall-cmd" class="headerlink" title="配置firewall-cmd"></a>配置firewall-cmd</h3><blockquote><p>查看版本：<br>firewall-cmd –version</p></blockquote><blockquote><p>查看帮助：<br>firewall-cmd –help</p></blockquote><blockquote><p>显示状态：<br>firewall-cmd –state</p></blockquote><blockquote><p>查看所有打开的端口：<br>firewall-cmd –zone=public –list-ports</p></blockquote><blockquote><p>更新防火墙规则：<br>firewall-cmd –reload</p></blockquote><blockquote><p>更新防火墙规则，重启服务：<br>firewall-cmd –completely-reload</p></blockquote><blockquote><p>查看已激活的Zone信息:<br>firewall-cmd –get-active-zones</p></blockquote><blockquote><p>查看指定接口所属区域：<br>firewall-cmd –get-zone-of-interface=eth0</p></blockquote><blockquote><p>拒绝所有包：<br>firewall-cmd –panic-on</p></blockquote><blockquote><p>取消拒绝状态：<br>firewall-cmd –panic-off</p></blockquote><blockquote><p>查看是否拒绝：<br>firewall-cmd –query-panic</p></blockquote><h3 id="firewall开启和关闭端口"><a href="#firewall开启和关闭端口" class="headerlink" title="firewall开启和关闭端口"></a>firewall开启和关闭端口</h3><p>-permanent永久生效，没有此参数重启后失效</p><blockquote><p>添加：<br>firewall-cmd –zone=public –add-port=80/tcp –permanent    </p></blockquote><blockquote><p>重新载入：<br>firewall-cmd –reload</p></blockquote><blockquote><p>查看：<br>firewall-cmd –zone=public –query-port=80/tcp</p></blockquote><blockquote><p>删除：<br>firewall-cmd –zone=public –remove-port=80/tcp –permanent</p></blockquote><p>示例：开通3306端口<br>firewall-cmd –zone=public –add-port=3306/tcp –permanent<br>firewall-cmd –reload</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      CentOS7防火墙操作命令
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.zhuqiaolun.com/categories/Linux/"/>
    
    
      <category term="firewall" scheme="https://www.zhuqiaolun.com/tags/firewall/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7服务器安装MySQL 8.0.25</title>
    <link href="https://www.zhuqiaolun.com/2021/06/1624440649011/1624440649011/"/>
    <id>https://www.zhuqiaolun.com/2021/06/1624440649011/1624440649011/</id>
    <published>2021-06-23T09:30:49.000Z</published>
    <updated>2021-06-24T07:49:44.907Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget lrzsz xz vim* libaio-devel.x86_64 numactl</span><br></pre></td></tr></tbody></table></figure></div><h3 id="MySQL地址"><a href="#MySQL地址" class="headerlink" title="MySQL地址"></a>MySQL地址</h3><p><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/mysql/</a><br><img src="/2021/06/1624440649011/1624440649011/20210623172848.png" alt="20210623172848"></p><p>鼠标右键复制链接地址<br><img src="/2021/06/1624440649011/1624440649011/20210623174431.png" alt="20210623174431"></p><h3 id="下载安装包"><a href="#下载安装包" class="headerlink" title="下载安装包"></a>下载安装包</h3><p>通过wget方式获取安装包</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/mysql</span><br><span class="line">cd /usr/local/mysql</span><br><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.25-linux-glibc2.12-x86_64.tar.xz</span><br></pre></td></tr></tbody></table></figure></div><h3 id="解压安装包"><a href="#解压安装包" class="headerlink" title="解压安装包"></a>解压安装包</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mysql</span><br><span class="line">xz -d mysql-8.0.25-linux-glibc2.12-x86_64.tar.xz</span><br><span class="line">tar -xf mysql-8.0.25-linux-glibc2.12-x86_64.tar</span><br></pre></td></tr></tbody></table></figure></div><h3 id="重命名"><a href="#重命名" class="headerlink" title="重命名"></a>重命名</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv mysql-8.0.25-linux-glibc2.12-x86_64 mysql-8.0.25</span><br></pre></td></tr></tbody></table></figure></div><h3 id="创建data目录"><a href="#创建data目录" class="headerlink" title="创建data目录"></a>创建data目录</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/mysql/mysql-8.0.25/data</span><br></pre></td></tr></tbody></table></figure></div><h3 id="创建用户组以及用户和密码以及授权"><a href="#创建用户组以及用户和密码以及授权" class="headerlink" title="创建用户组以及用户和密码以及授权"></a>创建用户组以及用户和密码以及授权</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd -g mysql mysql</span><br><span class="line">chown -R mysql.mysql /usr/local/mysql</span><br></pre></td></tr></tbody></table></figure></div><h3 id="初始化基础信息"><a href="#初始化基础信息" class="headerlink" title="初始化基础信息"></a>初始化基础信息</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mysql/mysql-8.0.25/bin/</span><br><span class="line">./mysqld --user=mysql --basedir=/usr/local/mysql/mysql-8.0.25 --datadir=/usr/local/mysql/mysql-8.0.25/data/ --initialize</span><br></pre></td></tr></tbody></table></figure></div><p>得到临时密码<br><img src="/2021/06/1624440649011/1624440649011/20210624141937.png" alt="20210624141937"></p><h3 id="编辑my-cnf文件"><a href="#编辑my-cnf文件" class="headerlink" title="编辑my.cnf文件"></a>编辑my.cnf文件</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></tbody></table></figure></div><p>内容：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">basedir=/usr/local/mysql/mysql-8.0.25</span><br><span class="line">datadir=/usr/local/mysql/mysql-8.0.25/data</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">character-set-server=utf8</span><br><span class="line">symbolic-links=0</span><br><span class="line">#bind-address = 127.0.0.1</span><br><span class="line">bind-address = 0.0.0.0</span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line">#log-error=/var/log/mariadb/mariadb.log</span><br><span class="line">#pid-file=/var/run/mariadb/mariadb.pid</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># include all files from the config directory</span><br><span class="line">#</span><br><span class="line">!includedir /etc/my.cnf.d</span><br></pre></td></tr></tbody></table></figure></div><h3 id="添加mysql服务到系统"><a href="#添加mysql服务到系统" class="headerlink" title="添加mysql服务到系统"></a>添加mysql服务到系统</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -a /usr/local/mysql/mysql-8.0.25/support-files/mysql.server /etc/init.d/mysql</span><br></pre></td></tr></tbody></table></figure></div><h3 id="授权以及添加服务"><a href="#授权以及添加服务" class="headerlink" title="授权以及添加服务"></a>授权以及添加服务</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/init.d/mysql</span><br><span class="line">chkconfig --add mysql</span><br></pre></td></tr></tbody></table></figure></div><h3 id="查看启动状态"><a href="#查看启动状态" class="headerlink" title="查看启动状态"></a>查看启动状态</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql status</span><br></pre></td></tr></tbody></table></figure></div><blockquote><p>显示：</p><blockquote><p>SUCCESS! MySQL running (16356)</p></blockquote></blockquote><h3 id="启动mysql"><a href="#启动mysql" class="headerlink" title="启动mysql"></a>启动mysql</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br></pre></td></tr></tbody></table></figure></div><blockquote><p>显示：</p><blockquote><p>Starting MySQL…. SUCCESS! </p></blockquote></blockquote><h3 id="停止mysql"><a href="#停止mysql" class="headerlink" title="停止mysql"></a>停止mysql</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql stop</span><br></pre></td></tr></tbody></table></figure></div><h3 id="将mysql命令添加到服务"><a href="#将mysql命令添加到服务" class="headerlink" title="将mysql命令添加到服务"></a>将mysql命令添加到服务</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/mysql/mysql-8.0.25/bin/mysql /usr/bin</span><br></pre></td></tr></tbody></table></figure></div><h3 id="重启mysql"><a href="#重启mysql" class="headerlink" title="重启mysql"></a>重启mysql</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></tbody></table></figure></div><h3 id="登录mysql"><a href="#登录mysql" class="headerlink" title="登录mysql"></a>登录mysql</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></tbody></table></figure></div><p><img src="/2021/06/1624440649011/1624440649011/20210624143714.png" alt="20210624143714"></p><h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><p>123456是新的密码</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line">ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root';</span><br><span class="line">flush privileges;</span><br></pre></td></tr></tbody></table></figure></div><h3 id="修改远程连接并生效"><a href="#修改远程连接并生效" class="headerlink" title="修改远程连接并生效"></a>修改远程连接并生效</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">update user set host='%' where user='root';</span><br><span class="line">flush privileges;</span><br></pre></td></tr></tbody></table></figure></div><h3 id="开通3306端口"><a href="#开通3306端口" class="headerlink" title="开通3306端口"></a>开通3306端口</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=3306/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></tbody></table></figure></div><h3 id="客户端连接"><a href="#客户端连接" class="headerlink" title="客户端连接"></a>客户端连接</h3><p><img src="/2021/06/1624440649011/1624440649011/20210624154900.png" alt="20210624154900"></p><p><a href="/2021/06/1624517875141/1624517875141/">防火墙</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      CentOS7服务器安装MySQL 8.0.25
    
    </summary>
    
    
      <category term="MySQL" scheme="https://www.zhuqiaolun.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="https://www.zhuqiaolun.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7服务器指令</title>
    <link href="https://www.zhuqiaolun.com/2021/06/1624439801367/1624439801367/"/>
    <id>https://www.zhuqiaolun.com/2021/06/1624439801367/1624439801367/</id>
    <published>2021-06-23T09:16:41.000Z</published>
    <updated>2021-06-24T07:38:30.901Z</updated>
    
    <content type="html"><![CDATA[<h3 id="查看当前Linux系统版本"><a href="#查看当前Linux系统版本" class="headerlink" title="查看当前Linux系统版本"></a>查看当前Linux系统版本</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br></pre></td></tr></tbody></table></figure></div><h3 id="更新yum源"><a href="#更新yum源" class="headerlink" title="更新yum源"></a>更新yum源</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></tbody></table></figure></div><h3 id="更新所有软件"><a href="#更新所有软件" class="headerlink" title="更新所有软件"></a>更新所有软件</h3><blockquote><p>列出所有可更新的软件清单命令<br>yum check-update</p></blockquote><blockquote><p>更新所有软件命令<br>yum update</p></blockquote><h3 id="清除缓存命令"><a href="#清除缓存命令" class="headerlink" title="清除缓存命令"></a>清除缓存命令</h3><blockquote><p>清除缓存目录下的软件包<br>yum clean packages</p></blockquote><blockquote><p>清除缓存目录下的 headers<br>yum clean headers</p></blockquote><blockquote><p>清除缓存目录下旧的 headers<br>yum clean oldheaders</p></blockquote><blockquote><p>清除缓存目录下的软件包及旧的headers<br>yum clean<br>yum clean all</p></blockquote><h3 id="下载文件：wget"><a href="#下载文件：wget" class="headerlink" title="下载文件：wget"></a>下载文件：wget</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line">下载Tomcat：wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.27/bin/apache-tomcat-9.0.27.tar.gz</span><br></pre></td></tr></tbody></table></figure></div><h3 id="文件传输：lrzsz"><a href="#文件传输：lrzsz" class="headerlink" title="文件传输：lrzsz"></a>文件传输：lrzsz</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum -y install lrzsz</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line">从服务端发送文件到客户端：sz filename</span><br><span class="line">从客户端上传文件到服务端：rz</span><br></pre></td></tr></tbody></table></figure></div><h3 id="解压文件：xz"><a href="#解压文件：xz" class="headerlink" title="解压文件：xz"></a>解压文件：xz</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum -y install xz </span><br><span class="line"></span><br><span class="line">eg：</span><br><span class="line">将xz文件解压为tar文件：xz -d example.tar.xz</span><br><span class="line">将tar文件解压：tar xf example.tar</span><br><span class="line"></span><br><span class="line">如果无法安装xz命令，先安装epel源：yum -y install epel-release</span><br></pre></td></tr></tbody></table></figure></div><h3 id="编辑器：vim"><a href="#编辑器：vim" class="headerlink" title="编辑器：vim"></a>编辑器：vim</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vim*</span><br></pre></td></tr></tbody></table></figure></div><h3 id="查看网络信息：netstat"><a href="#查看网络信息：netstat" class="headerlink" title="查看网络信息：netstat"></a>查看网络信息：netstat</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install net-tools</span><br></pre></td></tr></tbody></table></figure></div><p><a href="/2021/06/1624517875141/1624517875141/">防火墙</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      CentOS7服务器指令
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.zhuqiaolun.com/categories/Linux/"/>
    
    
      <category term="command" scheme="https://www.zhuqiaolun.com/tags/command/"/>
    
  </entry>
  
  <entry>
    <title>Nginx部署Vue项目，添加前缀访问</title>
    <link href="https://www.zhuqiaolun.com/2021/05/1620908327003/1620908327003/"/>
    <id>https://www.zhuqiaolun.com/2021/05/1620908327003/1620908327003/</id>
    <published>2021-05-13T12:18:46.000Z</published>
    <updated>2021-05-13T12:32:59.899Z</updated>
    
    <content type="html"><![CDATA[<p>首先准备1个vue项目</p><blockquote><p>hello/dist/<br>    - index.html</p></blockquote><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h3 id="根据路径访问"><a href="#根据路径访问" class="headerlink" title="根据路径访问"></a>根据路径访问</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">location / {</span><br><span class="line">    root html;</span><br><span class="line">    try_files $uri $uri/ /index.html;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">location /hello { </span><br><span class="line">    # vue项目的打包后的dist</span><br><span class="line">    alias D:/demon/hello/dist/;</span><br><span class="line">    try_files $uri $uri/ /hello/index.html;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>访问</p><blockquote><p><a href="http://127.0.0.1/hello" target="_blank" rel="noopener">http://127.0.0.1/hello</a></p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Nginx部署Vue项目，添加前缀访问
    
    </summary>
    
    
      <category term="Nginx" scheme="https://www.zhuqiaolun.com/categories/Nginx/"/>
    
    
      <category term="Vue" scheme="https://www.zhuqiaolun.com/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>Go-FastDfs 安装配置</title>
    <link href="https://www.zhuqiaolun.com/2021/05/1620815885110/1620815885110/"/>
    <id>https://www.zhuqiaolun.com/2021/05/1620815885110/1620815885110/</id>
    <published>2021-05-12T10:38:05.000Z</published>
    <updated>2021-11-27T18:04:09.649Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>项目地址：<a href="https://github.com/sjqzhang/go-fastdfs" target="_blank" rel="noopener">https://github.com/sjqzhang/go-fastdfs</a></p><p>编译版本下载地址：<a href="https://github.com/sjqzhang/go-fastdfs/releases" target="_blank" rel="noopener">https://github.com/sjqzhang/go-fastdfs/releases</a></p><p>中文Wiki地址：<a href="https://github.com/sjqzhang/go-fastdfs/blob/master/README.md" target="_blank" rel="noopener">https://github.com/sjqzhang/go-fastdfs/blob/master/README.md</a></p><p>gitee：<a href="https://gitee.com/sjqzhang/go-fastdfs" target="_blank" rel="noopener">https://gitee.com/sjqzhang/go-fastdfs</a></p><p>文档：<a href="https://sjqzhang.github.io/go-fastdfs/install.html" target="_blank" rel="noopener">https://sjqzhang.github.io/go-fastdfs/install.html</a></p><h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><pre><code>mkdir fastdfs &amp;&amp; cd fastdfswget --no-check-certificate  https://github.com/sjqzhang/go-fastdfs/releases/download/v1.4.1/fileserverchmod +x fileserver./fileserver</code></pre><h4 id="window"><a href="#window" class="headerlink" title="window"></a>window</h4><pre><code>下载时要注意链接的版本号，windows下直接运行 fileserver.exe</code></pre><p>运行完成后生成以下目录文件</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conf -- 配置</span><br><span class="line">data -- 数据</span><br><span class="line">files -- 文件</span><br><span class="line">log -- 日志</span><br><span class="line">static -- 静态页面</span><br></pre></td></tr></tbody></table></figure></div><blockquote><p>访问：localhost:8080 出现以下界面则运行成功</p></blockquote><p><img src="/2021/05/1620815885110/1620815885110/20210513133226.png" alt="20210513133226"></p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>配置文件在运行时自动生成，IP自动获取，端口默认8080；后面可根据需要自行修改端口配置；<br>配置文件去重算法为sha1，防止上传同一个文件导致为覆盖操作；<br>配置默认下载为false时，则可在返回的参数path后添加?download=0时在浏览器预览，path?download=1时在浏览器下载；</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><figcaption><span>json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    "绑定端号": "端口",</span><br><span class="line">    "addr": ":18080",</span><br><span class="line">    "是否开启https": "默认不开启，如需启开启，请在conf目录中增加证书文件 server.crt 私钥 文件 server.key",</span><br><span class="line">    "enable_https": false,</span><br><span class="line">    "PeerID": "集群内唯一,请使用0-9的单字符，默认自动生成",</span><br><span class="line">    "peer_id": "5",</span><br><span class="line">    "本主机地址": "本机http地址,默认自动生成(注意端口必须与addr中的端口一致），必段为内网，自动生成不为内网请自行修改，下同",</span><br><span class="line">    "host": "http://127.0.0.1:18080",</span><br><span class="line">    "集群": "集群列表,注意为了高可用，IP必须不能是同一个,同一不会自动备份，且不能为127.0.0.1,且必须为内网IP，默认自动生成",</span><br><span class="line">    "peers": ["http://127.0.0.1:18080"],</span><br><span class="line">    "组号": "用于区别不同的集群(上传或下载)与support_group_manage配合使用,带在下载路径中",</span><br><span class="line">    "group": "group1",</span><br><span class="line">    "是否支持按组（集群）管理,主要用途是Nginx支持多集群": "默认支持,不支持时路径为http://10.1.5.4:8080/action,支持时为http://10.1.5.4:8080/group(配置中的group参数)/action,action为动作名，如status,delete,sync等",</span><br><span class="line">    "support_group_manage": true,</span><br><span class="line">    "是否合并小文件": "默认不合并,合并可以解决inode不够用的情况（当前对于小于1M文件）进行合并",</span><br><span class="line">    "enable_merge_small_file": false,</span><br><span class="line">    "允许后缀名": "允许可以上传的文件后缀名，如jpg,jpeg,png等。留空允许所有。",</span><br><span class="line">    "extensions": [],</span><br><span class="line">    "重试同步失败文件的时间": "单位秒",</span><br><span class="line">    "refresh_interval": 1800,</span><br><span class="line">    "是否自动重命名": "默认不自动重命名,使用原文件名",</span><br><span class="line">    "rename_file": false,</span><br><span class="line">    "是否支持web上传,方便调试": "默认支持web上传",</span><br><span class="line">    "enable_web_upload": true,</span><br><span class="line">    "是否支持非日期路径": "默认支持非日期路径,也即支持自定义路径,需要上传文件时指定path",</span><br><span class="line">    "enable_custom_path": true,</span><br><span class="line">    "下载域名": "用于外网下载文件的域名,不包含http://",</span><br><span class="line">    "download_domain": "",</span><br><span class="line">    "场景列表": "当设定后，用户指的场景必项在列表中，默认不做限制(注意：如果想开启场景认功能，格式如下：'场景名:googleauth_secret' 如 default:N7IET373HB2C5M6D ",</span><br><span class="line">    "scenes": [],</span><br><span class="line">    "默认场景": "默认default",</span><br><span class="line">    "default_scene": "default",</span><br><span class="line">    "是否显示目录": "默认显示,方便调试用,上线时请关闭",</span><br><span class="line">    "show_dir": true,</span><br><span class="line">    "邮件配置": "",</span><br><span class="line">    "mail": {</span><br><span class="line">        "user": "abc@163.com",</span><br><span class="line">        "password": "abc",</span><br><span class="line">        "host": "smtp.163.com:25"</span><br><span class="line">    },</span><br><span class="line">    "告警接收邮件列表": "接收人数组",</span><br><span class="line">    "alarm_receivers": [],</span><br><span class="line">    "告警接收URL": "方法post,参数:subject,message",</span><br><span class="line">    "alarm_url": "",</span><br><span class="line">    "下载是否需带token": "真假",</span><br><span class="line">    "download_use_token": false,</span><br><span class="line">    "下载token过期时间": "单位秒",</span><br><span class="line">    "download_token_expire": 600,</span><br><span class="line">    "是否自动修复": "在超过1亿文件时出现性能问题，取消此选项，请手动按天同步，请查看FAQ",</span><br><span class="line">    "auto_repair": true,</span><br><span class="line">    "文件去重算法md5可能存在冲突，默认md5": "sha1|md5",</span><br><span class="line">    "file_sum_arithmetic": "sha1",</span><br><span class="line">    "管理ip列表": "用于管理集的ip白名单,",</span><br><span class="line">    "admin_ips": ["127.0.0.1"],</span><br><span class="line">    "是否启用迁移": "默认不启用",</span><br><span class="line">    "enable_migrate": false,</span><br><span class="line">    "文件是否去重": "默认去重",</span><br><span class="line">    "enable_distinct_file": true,</span><br><span class="line">    "是否开启跨站访问": "默认开启",</span><br><span class="line">    "enable_cross_origin": true,</span><br><span class="line">    "是否开启Google认证，实现安全的上传、下载": "默认不开启",</span><br><span class="line">    "enable_google_auth": false,</span><br><span class="line">    "认证url": "当url不为空时生效,注意:普通上传中使用http参数 auth_token 作为认证参数, 在断点续传中通过HTTP头Upload-Metadata中的auth_token作为认证参数,认证流程参考认证架构图",</span><br><span class="line">    "auth_url": "",</span><br><span class="line">    "下载是否认证": "默认不认证(注意此选项是在auth_url不为空的情况下生效)",</span><br><span class="line">    "enable_download_auth": false,</span><br><span class="line">    "默认是否下载": "默认下载",</span><br><span class="line">    "default_download": false,</span><br><span class="line">    "本机是否只读": "默认可读可写",</span><br><span class="line">    "read_only": false,</span><br><span class="line">    "是否开启断点续传": "默认开启",</span><br><span class="line">    "enable_tus": true,</span><br><span class="line">    "同步单一文件超时时间（单位秒）": "默认为0,程序自动计算，在特殊情况下，自已设定",</span><br><span class="line">    "sync_timeout": 0</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p><a href="/2021/11/1636190973137/1636190973137/">传送门</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      Go-FastDfs
    
    </summary>
    
    
      <category term="Go-FastDfs" scheme="https://www.zhuqiaolun.com/categories/Go-FastDfs/"/>
    
    
      <category term="Go-FastDfs" scheme="https://www.zhuqiaolun.com/tags/Go-FastDfs/"/>
    
  </entry>
  
  <entry>
    <title>使用NSSM把exe可执行文件注册为Windows服务,开机启动&amp;后台运行</title>
    <link href="https://www.zhuqiaolun.com/2021/05/1620813081711/1620813081711/"/>
    <id>https://www.zhuqiaolun.com/2021/05/1620813081711/1620813081711/</id>
    <published>2021-05-12T09:51:21.000Z</published>
    <updated>2021-05-12T10:34:03.959Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><a href="http://www.nssm.cc/" target="_blank" rel="noopener">NSSM</a>是一款可将exe注册为Windows系统服务的工具。当你的exe程序需要部署在Windows Server上时，NSSM是一个不错的选择。<br>注册为服务后，启动、停止、重启皆由windows来管理，所以不必担心exe因意外的停止，而Windows的服务管理即可处理这些问题。</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>官网<a href="http://www.nssm.cc/download" target="_blank" rel="noopener">下载</a>页面; 版本：<a href="http://www.nssm.cc/release/nssm-2.24.zip" target="_blank" rel="noopener">2.24</a></p><p>根据自己的平台，将32/64位nssm.exe文件解压至任意文件夹</p><p>以管理员身份运行CMD定位至nssm.exe所在目录</p><p>输入 nssm install {服务名称}，即注册服务的名称。注册服务弹出如下NSSM界面<br><img src="/2021/05/1620813081711/1620813081711/20210512181351.png" alt="20210512181351"></p><p>以安装Redis为例<br><img src="/2021/05/1620813081711/1620813081711/20210512182309.png" alt="20210512182309"></p><p>查询服务状态</p><pre><code>E:\nssm-2.24-101\win64&gt;nssm.exe status RedisSERVICE_STOPPED</code></pre><p>nssm常用命令：</p><blockquote><p>创建服务：nssm install servername </p></blockquote><blockquote><p>启动服务：nssm start servername </p></blockquote><blockquote><p>暂停服务：nssm stop servername </p></blockquote><blockquote><p>重启服务：nssm restart servername </p></blockquote><blockquote><p>删除服务：nssm remove servername </p></blockquote><p>更多命令<a href="http://www.nssm.cc/usage" target="_blank" rel="noopener">查看</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      使用NSSM把exe可执行文件注册为Windows服务,开机启动&amp;后台运行
    
    </summary>
    
    
      <category term="工具" scheme="https://www.zhuqiaolun.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="exe" scheme="https://www.zhuqiaolun.com/tags/exe/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis-Plus的集成配置</title>
    <link href="https://www.zhuqiaolun.com/2021/04/1617878968965/1617878968965/"/>
    <id>https://www.zhuqiaolun.com/2021/04/1617878968965/1617878968965/</id>
    <published>2021-04-08T10:49:28.000Z</published>
    <updated>2021-07-02T02:46:09.020Z</updated>
    
    <content type="html"><![CDATA[<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p>添加依赖</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 连接数据库 start --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库 连接 、事务--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库 mybatis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库 mysql--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 连接数据库 end --&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>配置bean使用插件</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line">import com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @className: MybatisPlusConfig.java</span><br><span class="line"> * @description:  MyBatis-Plus的插件配置</span><br><span class="line"> * @author: Demon</span><br><span class="line"> * @date 2020/8/25 11:24</span><br><span class="line"> */</span><br><span class="line">@Configuration</span><br><span class="line">@EnableTransactionManagement</span><br><span class="line">public class MybatisPlusConfig {</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 分页插件</span><br><span class="line">     * paginationInterceptor.setLimit(你的最大单页限制数量，默认 500 条，小于 0 如 -1 不受限制);</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public PaginationInterceptor paginationInterceptor() {</span><br><span class="line">        PaginationInterceptor paginationInterceptor = new PaginationInterceptor();</span><br><span class="line">        </span><br><span class="line">        // 设置请求的页面大于最大页后操作， true调回到首页，false 继续请求  默认false</span><br><span class="line">        paginationInterceptor.setOverflow(false);</span><br><span class="line">        </span><br><span class="line">        // 设置最大单页限制数量，默认 500 条，-1 不受限制</span><br><span class="line">        paginationInterceptor.setLimit(-1);</span><br><span class="line">        </span><br><span class="line">        // 设置数据库需要根据mp版本使用set方法,以下为3.3.2</span><br><span class="line">        paginationInterceptor.setDbType(DbType.MYSQL);</span><br><span class="line">        </span><br><span class="line">        // 设置数据库需要根据mp版本使用set方法,以下为3.2.0</span><br><span class="line">        paginationInterceptor.setDialectType(DbType.MYSQL.getDb());</span><br><span class="line">        </span><br><span class="line">        return paginationInterceptor;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><h3 id="添加事务"><a href="#添加事务" class="headerlink" title="添加事务"></a>添加事务</h3><p>在实现类的 增删改方法内添加</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Transactional(propagation = Propagation.NESTED, rollbackFor = Exception.class)</span><br></pre></td></tr></tbody></table></figure></div><p>PROPAGATION_NESTED：</p><blockquote><p>如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则进行与PROPAGATION_REQUIRED类似的操作。</p></blockquote><p>PROPAGATION_REQUIRED：</p><blockquote><p>支持当前事务，如果当前没有事务，就新建一个事务。</p></blockquote><h3 id="yml配置"><a href="#yml配置" class="headerlink" title="yml配置"></a>yml配置</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  # 数据库连接</span><br><span class="line">  datasource:</span><br><span class="line">    driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">    url: jdbc:mysql://127.0.0.1:3306/demo?useUnicode=true&amp;characterEncoding=utf8&amp;characterSetResults=utf8&amp;allowMultiQueries=true&amp;autoReconnect=true&amp;useSSL=false&amp;serverTimezone=UTC&amp;zeroDateTimeBehavior=convertToNull</span><br><span class="line">    username: root</span><br><span class="line">    password: root</span><br><span class="line">    # Spring Boot 2.0及以上版本 默认选择，不需要配置</span><br><span class="line">    type: com.zaxxer.hikari.HikariDataSource</span><br><span class="line">    hikari:</span><br><span class="line">      # 客户端等待连接池连接的最大毫秒数</span><br><span class="line">      connection-timeout: 20000</span><br><span class="line">      # 连接池中维护的最小空闲连接数</span><br><span class="line">      minimum-idle: 5</span><br><span class="line">      # 配置最大池大小</span><br><span class="line">      maximum-pool-size: 12</span><br><span class="line">      # 允许连接在连接池中空闲的最长时间（以毫秒为单位）</span><br><span class="line">      idle-timeout: 300000</span><br><span class="line">      # 池中连接关闭后的最长生命周期（以毫秒为单位）</span><br><span class="line">      max-lifetime: 1200000</span><br><span class="line">      # 从池返回的连接的默认自动提交行为。默认值为true。</span><br><span class="line">      auto-commit: true</span><br><span class="line"></span><br><span class="line"># mybatis-plus配置</span><br><span class="line">mybatis-plus:</span><br><span class="line">  # MyBatis 配置文件</span><br><span class="line">  configuration:</span><br><span class="line">    # 映射器启用缓存</span><br><span class="line">    cache-enabled: false</span><br><span class="line">    # 查询时，关闭关联对象即时加载以提高性能</span><br><span class="line">    lazy-loading-enabled: false</span><br><span class="line">    # 不允许使用自定义的主键值(比如由程序生成的UUID 32位编码作为键值), 数据表的PK生成策略将被覆盖</span><br><span class="line">    use-generated-keys: false</span><br><span class="line">    # 对于批量更新操作缓存SQL以提高性能 SIMPLE, REUSE, BATCH</span><br><span class="line">    default-executor-type: reuse</span><br><span class="line">    # 对于未知的SQL查询，允许返回不同的结果集以达到通用的效果</span><br><span class="line">    multiple-result-sets-enabled: true</span><br><span class="line">    # 允许使用列标签代替列名</span><br><span class="line">    use-column-label: true</span><br><span class="line">    # 解决mybatis空字段null字段不返回</span><br><span class="line">    call-setters-on-nulls: true</span><br><span class="line">    # 给予被嵌套的resultMap以字段-属性的映射支持 NONE, FULL,PARTIAL</span><br><span class="line">    auto-mapping-behavior: partial</span><br><span class="line">    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl</span><br><span class="line">  # 启动时是否检查 MyBatis XML 文件的存在，默认不检查。</span><br><span class="line">  check-config-location: false</span><br><span class="line">  # mapper.xml所在位置</span><br><span class="line">  mapper-locations: classpath*:/mapper/*Mapper.xml</span><br></pre></td></tr></tbody></table></figure></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      MyBatis-Plus的yml配置
    
    </summary>
    
    
      <category term="MyBatis" scheme="https://www.zhuqiaolun.com/categories/MyBatis/"/>
    
    
      <category term="Java" scheme="https://www.zhuqiaolun.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>WebService服务端开发 - SpringBoot</title>
    <link href="https://www.zhuqiaolun.com/2021/03/1617086122645/1617086122645/"/>
    <id>https://www.zhuqiaolun.com/2021/03/1617086122645/1617086122645/</id>
    <published>2021-03-30T06:35:22.000Z</published>
    <updated>2021-05-13T05:43:49.863Z</updated>
    
    <content type="html"><![CDATA[<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.cxf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cxf-spring-boot-starter-jaxws<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="yml配置"><a href="#yml配置" class="headerlink" title="yml配置"></a>yml配置</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8069</span><br><span class="line">  servlet:</span><br><span class="line">    context-path: /spring-boot-webservice-service</span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: spring-boot-webservice-service</span><br><span class="line"></span><br><span class="line"># 发布服务名称：http://localhost:8069/spring-boot-webservice-service/ws</span><br><span class="line">cxf:</span><br><span class="line">  path: /ws</span><br></pre></td></tr></tbody></table></figure></div><h3 id="创建接口"><a href="#创建接口" class="headerlink" title="创建接口"></a>创建接口</h3><p>在创建接口时请将实现类与之放在同一级目录下，这样在endpointInterface时容易找到<br><img src="/2021/03/1617086122645/1617086122645/20210330144330.png" alt="20210330144330"></p><p>ExampleService：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import javax.jws.WebMethod;</span><br><span class="line">import javax.jws.WebParam;</span><br><span class="line">import javax.jws.WebResult;</span><br><span class="line">import javax.jws.WebService;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName: exampleService</span><br><span class="line"> * @Description: ExampleService接口</span><br><span class="line"> * @Author: Demon</span><br><span class="line"> */</span><br><span class="line">@WebService(name = "ExampleService")</span><br><span class="line">public interface ExampleService {</span><br><span class="line"></span><br><span class="line">    @WebMethod</span><br><span class="line">    @WebResult</span><br><span class="line">    String getTime();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * sayHello</span><br><span class="line">     * @param userName 用户名</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    @WebMethod</span><br><span class="line">    @WebResult</span><br><span class="line">    String sayHello(@WebParam(name = "userName") String userName);</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><p>ExampleServiceImpl：</p><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.DocumentHelper;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import javax.jws.WebService;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName: ExampleController</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Author: Demon</span><br><span class="line"> </span><br><span class="line"> * serviceName:【对外发布的服务名 】：需要见名知意</span><br><span class="line"> * targetNamespace:【名称空间】：【实现类包名的反缀】</span><br><span class="line"> * endpointInterface :【服务接口全路径】 【接口的包名】</span><br><span class="line"> */</span><br><span class="line">@Component</span><br><span class="line">@WebService(</span><br><span class="line">        serviceName = "ExampleService",</span><br><span class="line">        targetNamespace="http://example.webservice.springbootwebservice.demon.com/",</span><br><span class="line">        endpointInterface = "com.demon.springbootwebservice.webservice.example.ExampleService"</span><br><span class="line">)</span><br><span class="line">public class ExampleServiceImpl implements ExampleService {</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getTime() {</span><br><span class="line">        return String.valueOf(System.currentTimeMillis());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String sayHello(String userName) {</span><br><span class="line">        System.out.println("=======================&gt;"+userName);</span><br><span class="line">        return userName;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><h3 id="WebServiceConfig配置类"><a href="#WebServiceConfig配置类" class="headerlink" title="WebServiceConfig配置类"></a>WebServiceConfig配置类</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import org.apache.cxf.Bus;</span><br><span class="line">import org.apache.cxf.bus.spring.SpringBus;</span><br><span class="line">import org.apache.cxf.jaxws.EndpointImpl;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">import javax.xml.ws.Endpoint;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName: WebServiceConfig</span><br><span class="line"> * @Description: 配置类</span><br><span class="line"> * @Author: Demon</span><br><span class="line"> */</span><br><span class="line">@Configuration</span><br><span class="line">public class WebServiceConfig {</span><br><span class="line">    </span><br><span class="line">    @Bean(name = Bus.DEFAULT_BUS_ID)</span><br><span class="line">    public SpringBus springBus() {</span><br><span class="line">        return new SpringBus();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ExampleService --- sayHello</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public Endpoint exampleServiceBean() {</span><br><span class="line">        // 绑定要发布的服务实现类</span><br><span class="line">        EndpointImpl endpoint = new EndpointImpl(springBus(), new ExampleServiceImpl());</span><br><span class="line">        // 接口访问地址</span><br><span class="line">        endpoint.publish("/exampleService");</span><br><span class="line">        return endpoint;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * TestService --- getTest</span><br><span class="line">     * @return 返回</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public Endpoint testServiceBean() {</span><br><span class="line">        // 绑定要发布的服务实现类</span><br><span class="line">        EndpointImpl endpoint = new EndpointImpl(springBus(), new TestServiceImpl());</span><br><span class="line">        // 接口访问地址</span><br><span class="line">        endpoint.publish("/testService");</span><br><span class="line">        return endpoint;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div><h3 id="访问结果"><a href="#访问结果" class="headerlink" title="访问结果"></a>访问结果</h3><p>访问路径：<a href="http://localhost:8069/spring-boot-webservice-service/ws" target="_blank" rel="noopener">http://localhost:8069/spring-boot-webservice-service/ws</a><br><img src="/2021/03/1617086122645/1617086122645/20210330153035.png" alt="20210330153035"><br><img src="/2021/03/1617086122645/1617086122645/20210330153710.png" alt="20210330153710"><br><img src="/2021/03/1617086122645/1617086122645/20210330153725.png" alt="20210330153725"></p><h3 id="客户端请求"><a href="#客户端请求" class="headerlink" title="客户端请求"></a>客户端请求</h3><p><a href="/2021/03/1617084469964/1617084469964/"> axis客户端请求</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
    
    <summary type="html">
    
      WebService服务端开发 - SpringBoot
    
    </summary>
    
    
      <category term="WebService" scheme="https://www.zhuqiaolun.com/categories/WebService/"/>
    
    
      <category term="SpringBoot" scheme="https://www.zhuqiaolun.com/tags/SpringBoot/"/>
    
  </entry>
  
</feed>
